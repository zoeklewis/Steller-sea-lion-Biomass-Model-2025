<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zoë Lewis and Benjamin Nelson">
<meta name="dcterms.date" content="2025-10-22">

<title>Consumption of Chinook salmon by Steller sea lions along the northwest coast of Washington</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SSL_consumption_11_20_24_files/libs/clipboard/clipboard.min.js"></script>
<script src="SSL_consumption_11_20_24_files/libs/quarto-html/quarto.js"></script>
<script src="SSL_consumption_11_20_24_files/libs/quarto-html/popper.min.js"></script>
<script src="SSL_consumption_11_20_24_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SSL_consumption_11_20_24_files/libs/quarto-html/anchor.min.js"></script>
<link href="SSL_consumption_11_20_24_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SSL_consumption_11_20_24_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="SSL_consumption_11_20_24_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="SSL_consumption_11_20_24_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SSL_consumption_11_20_24_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SSL_consumption_11_20_24_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="SSL_consumption_11_20_24_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#description-of-model" id="toc-description-of-model" class="nav-link active" data-scroll-target="#description-of-model"><span class="header-section-number">1</span> Description of Model</a>
  <ul class="collapse">
  <li><a href="#required-packages" id="toc-required-packages" class="nav-link" data-scroll-target="#required-packages"><span class="header-section-number">1.1</span> Required packages</a></li>
  </ul></li>
  <li><a href="#steller-sea-lion-consumption-model---scordino-et-al.-2022" id="toc-steller-sea-lion-consumption-model---scordino-et-al.-2022" class="nav-link" data-scroll-target="#steller-sea-lion-consumption-model---scordino-et-al.-2022"><span class="header-section-number">2</span> Steller sea lion consumption Model - Scordino et al.&nbsp;2022</a>
  <ul class="collapse">
  <li><a href="#individual-steller-sea-lion-daily-consumption" id="toc-individual-steller-sea-lion-daily-consumption" class="nav-link" data-scroll-target="#individual-steller-sea-lion-daily-consumption"><span class="header-section-number">2.1</span> Individual Steller sea lion daily consumption</a></li>
  <li><a href="#modeling-abundance" id="toc-modeling-abundance" class="nav-link" data-scroll-target="#modeling-abundance"><span class="header-section-number">2.2</span> Modeling abundance</a></li>
  <li><a href="#biomass-calculation" id="toc-biomass-calculation" class="nav-link" data-scroll-target="#biomass-calculation"><span class="header-section-number">2.3</span> Biomass calculation</a></li>
  <li><a href="#results-total-biomass-metric-tons-consumed" id="toc-results-total-biomass-metric-tons-consumed" class="nav-link" data-scroll-target="#results-total-biomass-metric-tons-consumed"><span class="header-section-number">2.4</span> <strong>Results: Total biomass (metric tons) consumed</strong></a></li>
  </ul></li>
  <li><a href="#zoib-model-for-chinook-diet-proportions" id="toc-zoib-model-for-chinook-diet-proportions" class="nav-link" data-scroll-target="#zoib-model-for-chinook-diet-proportions"><span class="header-section-number">3</span> ZOIB model for Chinook Diet Proportions</a>
  <ul class="collapse">
  <li><a href="#data-setup" id="toc-data-setup" class="nav-link" data-scroll-target="#data-setup"><span class="header-section-number">3.1</span> Data setup</a></li>
  <li><a href="#plot-of-sample-diet-proportions-by-season-and-sex" id="toc-plot-of-sample-diet-proportions-by-season-and-sex" class="nav-link" data-scroll-target="#plot-of-sample-diet-proportions-by-season-and-sex"><span class="header-section-number">3.2</span> Plot of sample diet proportions, by season and sex</a></li>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model"><span class="header-section-number">3.3</span> Fit the model</a></li>
  <li><a href="#produce-n-samples-from-the-posterior-predictive-distributions-for-each-season" id="toc-produce-n-samples-from-the-posterior-predictive-distributions-for-each-season" class="nav-link" data-scroll-target="#produce-n-samples-from-the-posterior-predictive-distributions-for-each-season"><span class="header-section-number">3.4</span> Produce n samples from the posterior predictive distributions, for each season</a></li>
  <li><a href="#plot-seasonal-diet-proportions-histogram-of-n_samples" id="toc-plot-seasonal-diet-proportions-histogram-of-n_samples" class="nav-link" data-scroll-target="#plot-seasonal-diet-proportions-histogram-of-n_samples"><span class="header-section-number">3.5</span> Plot seasonal diet proportions (histogram of n_samples)</a></li>
  </ul></li>
  <li><a href="#total-chinook-biomass-consumed" id="toc-total-chinook-biomass-consumed" class="nav-link" data-scroll-target="#total-chinook-biomass-consumed"><span class="header-section-number">4</span> Total Chinook biomass consumed</a>
  <ul class="collapse">
  <li><a href="#chinook-diet-percentage-from-zoib-model" id="toc-chinook-diet-percentage-from-zoib-model" class="nav-link" data-scroll-target="#chinook-diet-percentage-from-zoib-model"><span class="header-section-number">4.1</span> Chinook diet percentage from ZOIB model</a></li>
  <li><a href="#seasonal-consumption-of-chinook-biomass-in-metric-tons" id="toc-seasonal-consumption-of-chinook-biomass-in-metric-tons" class="nav-link" data-scroll-target="#seasonal-consumption-of-chinook-biomass-in-metric-tons"><span class="header-section-number">4.2</span> Seasonal consumption of Chinook Biomass (in metric tons)</a></li>
  <li><a href="#summary-of-chinook-biomass-in-metric-tons-consumed-by-ssl" id="toc-summary-of-chinook-biomass-in-metric-tons-consumed-by-ssl" class="nav-link" data-scroll-target="#summary-of-chinook-biomass-in-metric-tons-consumed-by-ssl"><span class="header-section-number">4.3</span> Summary of Chinook Biomass (in metric tons) consumed by SSL</a></li>
  </ul></li>
  <li><a href="#part-4-consumption-of-age-0-chinook" id="toc-part-4-consumption-of-age-0-chinook" class="nav-link" data-scroll-target="#part-4-consumption-of-age-0-chinook"><span class="header-section-number">5</span> Part 4: Consumption of Age-0 Chinook</a>
  <ul class="collapse">
  <li><a href="#adding-uncertainty-around-age-0-proportions" id="toc-adding-uncertainty-around-age-0-proportions" class="nav-link" data-scroll-target="#adding-uncertainty-around-age-0-proportions"><span class="header-section-number">5.1</span> Adding uncertainty around age-0 proportions</a></li>
  <li><a href="#determining-age-0-diet-proportion-of-total-diet" id="toc-determining-age-0-diet-proportion-of-total-diet" class="nav-link" data-scroll-target="#determining-age-0-diet-proportion-of-total-diet"><span class="header-section-number">5.2</span> Determining Age-0 diet proportion of total diet</a></li>
  </ul></li>
  <li><a href="#function-to-calculate-age-0-biomass-metric-tons-for-each-season-and-adjusted-proportion" id="toc-function-to-calculate-age-0-biomass-metric-tons-for-each-season-and-adjusted-proportion" class="nav-link" data-scroll-target="#function-to-calculate-age-0-biomass-metric-tons-for-each-season-and-adjusted-proportion"><span class="header-section-number">6</span> Function to calculate age-0 biomass (metric tons) for each season and adjusted proportion</a>
  <ul class="collapse">
  <li><a href="#number-of-age-0-chinook-consumed" id="toc-number-of-age-0-chinook-consumed" class="nav-link" data-scroll-target="#number-of-age-0-chinook-consumed"><span class="header-section-number">6.1</span> Number of Age-0 Chinook consumed</a></li>
  <li><a href="#overall-calculations" id="toc-overall-calculations" class="nav-link" data-scroll-target="#overall-calculations"><span class="header-section-number">6.2</span> Overall calculations</a></li>
  </ul></li>
  <li><a href="#daily-consumption-of-chinook-salmon-per-individual-steller-sea-lion" id="toc-daily-consumption-of-chinook-salmon-per-individual-steller-sea-lion" class="nav-link" data-scroll-target="#daily-consumption-of-chinook-salmon-per-individual-steller-sea-lion"><span class="header-section-number">7</span> Daily consumption of Chinook salmon per individual Steller sea lion</a>
  <ul class="collapse">
  <li><a href="#daily-biomass-of-age-0-chinook-salmon-consumed-per-ssl-demographic" id="toc-daily-biomass-of-age-0-chinook-salmon-consumed-per-ssl-demographic" class="nav-link" data-scroll-target="#daily-biomass-of-age-0-chinook-salmon-consumed-per-ssl-demographic"><span class="header-section-number">7.1</span> Daily biomass of age-0 Chinook salmon consumed per SSL demographic</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Consumption of Chinook salmon by Steller sea lions along the northwest coast of Washington</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zoë Lewis and Benjamin Nelson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 22, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="description-of-model" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Description of Model</h1>
<p>Biomass of Chinook salmon consumed by Steller sea lions between December 2020-August 2021 along the northwest coast of Washington.</p>
<p>First, we describe prey consumption models for Steller sea lions (SSL) adapted from <span class="citation" data-cites="scordino2022">@scordino2022</span>. This model was developed to determine the biomass consumed by Steller sea lions between 2010-2013 along the northwest coast of Washington using hard parts identification of prey items within scat. Thus, we use many of the same parameters, however, abundance parameters changed based on updated counts of Steller sea lions in the region. Using this model, we first estimate the total biomass consumed by these Steller sea lions.</p>
<p>Second, we used new DNA metabarcoding diet data to estimate the seasonal proportion of Chinook within Steller sea lion diet. Given that the data are zero-inflated, proportion data, we use ZOIB modeling (described in both the html and the rmd file titled “ZOIB model”, as well as in <span class="citation" data-cites="nelson2021a">@nelson2021a</span>) to determine seasonal proportions of Chinook consumed .</p>
<p>Third, we used the ZOIB modeling protocol to estimate the seasonal diet proportion of age-0 Chinook salmon consumed to determine the biomass and the number of age-0 Chinook salmon consumed by Steller sea lions along the northwest coast of Washington State. Then, we estimate the number of individual age-0 Chinook salmon consumed by Steller sea lions given previously used length distributions found in <span class="citation" data-cites="chasco2017">@chasco2017</span>.</p>
<section id="required-packages" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="required-packages"><span class="header-section-number">1.1</span> Required packages</h2>
<p>In this step, all necessary R packages are downloaded to produce the necessary outputs for the model.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>() </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoib)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lemon)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'scales'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="steller-sea-lion-consumption-model---scordino-et-al.-2022" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Steller sea lion consumption Model - Scordino et al.&nbsp;2022</h1>
<p>There are three steps to calculate the total biomass of prey consumed by Steller sea lions along the coast of Washington state, similar to the steps taken in <span class="citation" data-cites="scordino2022">@scordino2022</span>.</p>
<ol type="1">
<li><p>Calculate individual Steller sea lion daily consumption</p></li>
<li><p>Model abundance and determine abundance functions</p></li>
<li><p>Calculate total biomass consumed using consumption and abundance</p></li>
</ol>
<section id="individual-steller-sea-lion-daily-consumption" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="individual-steller-sea-lion-daily-consumption"><span class="header-section-number">2.1</span> Individual Steller sea lion daily consumption</h2>
<p>This section describes the distributions used to determine the daily consumption (in kilograms) of Steller sea lions based on their age, and sex. Parameters are derived from <span class="citation" data-cites="winship2006">@winship2006</span>; <span class="citation" data-cites="winship2001">@winship2001</span>, and the overall biomass model presented first in <span class="citation" data-cites="scordino2022">@scordino2022</span>.</p>
<section id="body-weight-consumed" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="body-weight-consumed"><span class="header-section-number">2.1.1</span> % body weight consumed</h3>
<p>Percent body weight consumed based on body weight estimates and sex are the same as those used in “Dietary niche overlap and prey consumption estimates for Steller sea lion and California sea lion in northwest Washington 2010-2013” <span class="citation" data-cites="scordino2022">@scordino2022</span>. Percent body weight consumed determined using either normal distribution or uniform distributions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Female P </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>FLarge <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>FMed <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.06</span>,<span class="fl">0.07</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>FMedSm <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.07</span>,<span class="fl">0.08</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>FSmall <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.08</span>,<span class="fl">0.09</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Male P </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>MLarge <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.03</span>,<span class="fl">0.04</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>MMed <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.04</span>,<span class="fl">0.01</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>MMedSm <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.05</span>,<span class="fl">0.06</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>MSmall <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.06</span>,<span class="fl">0.07</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>MVSmall <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.08</span>,<span class="fl">0.09</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="daily-consumption" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="daily-consumption"><span class="header-section-number">2.1.2</span> Daily consumption</h3>
<p>Functions used to determine the daily consumption of prey (kg/day) by SSL is defined in <span class="citation" data-cites="scordino2022">@scordino2022</span>: “Formulas for estimating the daily consumption of a randomly drawn juvenile female juvenile male, adult female, and adult male using the consumption of body weight parameters defined above and the uniform distribution of reported weight at age for each age and sex class as reported in <span class="citation" data-cites="winship2001">@winship2001</span>. Juvenile weights are for sea lions ages 1 to 5. Juvenile females use non-pregnant 5 year old weight as the maximum weight for the category. Adults use age classes of 5 up to maximum growth from <span class="citation" data-cites="winship2001">@winship2001</span>.”</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Individual daily consumption juvenile female (I)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>IndDailyConsumptionJuvF<span class="ot">&lt;-</span> <span class="cf">function</span>() </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  JuvF <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">89</span>,<span class="dv">195</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(JuvF <span class="sc">&gt;</span> <span class="dv">194</span>){JuvF<span class="sc">*</span>FMed}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(JuvF <span class="sc">&gt;</span> <span class="dv">152</span>){JuvF<span class="sc">*</span>FMedSm}</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(JuvF <span class="sc">&gt;</span> <span class="dv">89</span>){JuvF<span class="sc">*</span>FSmall}</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Individual daily consumption adult female (I)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>IndDailyConsumptionAdF<span class="ot">&lt;-</span> <span class="cf">function</span>() </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  AdFemale <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">195</span>,<span class="dv">305</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(AdFemale <span class="sc">&gt;</span> <span class="dv">223</span>){AdFemale<span class="sc">*</span>FLarge}</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(AdFemale <span class="sc">&gt;</span> <span class="dv">195</span>){AdFemale<span class="sc">*</span>FMed}</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Individual daily consumption juvenile male (I)</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>IndDailyConsumptionJuvM<span class="ot">&lt;-</span> <span class="cf">function</span>() </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  JuvM <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">125</span>,<span class="dv">286</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(JuvM <span class="sc">&gt;</span> <span class="dv">182</span>){JuvM<span class="sc">*</span>MSmall}</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(JuvM <span class="sc">&gt;</span> <span class="dv">125</span>){JuvM<span class="sc">*</span>MVSmall}</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Individual daily consumption adult male (I)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>IndDailyConsumptionAdM<span class="ot">&lt;-</span> <span class="cf">function</span>() </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  AdMale <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">286</span>,<span class="dv">681</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(AdMale <span class="sc">&gt;</span> <span class="dv">623</span>){AdMale<span class="sc">*</span>MLarge}</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(AdMale <span class="sc">&gt;</span> <span class="dv">455</span>){AdMale<span class="sc">*</span>MMed}</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(AdMale <span class="sc">&gt;</span> <span class="dv">310</span>){AdMale<span class="sc">*</span>MMedSm}</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(AdMale <span class="sc">&gt;</span> <span class="dv">286</span>) {AdMale<span class="sc">*</span>MSmall}</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="modeling-abundance" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="modeling-abundance"><span class="header-section-number">2.2</span> Modeling abundance</h2>
<p>Counts are from surveys conducted from 2020-2021 data counts only.</p>
<p>Count data was only used from days that included all local haulouts surveyed. Raw data for the counts are available from Scordino and Akmajian 2021. Abundance functions were modeled using a negative binomial distribution.</p>
<p><strong>Table 1</strong>: Negative binomial parameters for modeling Steller sea lion abundance along the northwest coast of Washington State between December 2020-August 2021.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"><strong>Season</strong></th>
<th style="text-align: center;"><strong>Mean</strong></th>
<th style="text-align: center;"><strong>Size</strong></th>
<th style="text-align: center;"><strong>n</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Winter</td>
<td style="text-align: center;">976.33</td>
<td style="text-align: center;">36.34</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;">Spring</td>
<td style="text-align: center;">888.29</td>
<td style="text-align: center;">32.10</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Summer</td>
<td style="text-align: center;">969.77</td>
<td style="text-align: center;">25.80</td>
<td style="text-align: center;">13</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Winter Steller sea lion abundance</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>WinAbund <span class="ot">&lt;-</span> <span class="cf">function</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">mu=</span><span class="fl">976.3333</span>, <span class="at">size=</span><span class="fl">36.34341</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Spring Steller sea lion abundance</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>SprAbund <span class="ot">&lt;-</span> <span class="cf">function</span>()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">mu=</span><span class="fl">888.2857</span>, <span class="at">size=</span><span class="fl">32.07886</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Summer Steller sea lion abundance</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>SumAbund <span class="ot">&lt;-</span> <span class="cf">function</span>()</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">mu=</span><span class="fl">969.7692</span>, <span class="at">size=</span><span class="fl">25.796</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="count-correction-factor-functions" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="count-correction-factor-functions"><span class="header-section-number">2.2.1</span> Count correction factor functions</h3>
<p>Correction factors are the same as correction factors used in <span class="citation" data-cites="scordino2022">@scordino2022</span>,</p>
<p>Methods from <span class="citation" data-cites="scordino2022">@scordino2022</span> describe seasonal count correction factors as follows:</p>
<p>“Correction factors from Olesiuk 2018 were used assuming that the correction factor for fall and spring have the same CF as caculated for winter. This assumption is supported by the findings of Whitlock et al.&nbsp;2020 of very low attendance in May and by the end of August that were similar to Olesiuk’s estimate for winter CF. Overall the correction factors from Olesiuk 2018 were similar to the estimates of Whitlock et al.&nbsp;2020. These correction factors were for Steller sea lions. Olesiuk found that 36% of non-pups (SD=2.1%) were hauled out in fall, winter, and spring during the time window of 10:00 - 18:00 when our counts typically occurred. During summer Olesiuk found that 67.4% of non-pups (SD= 5.6%) were hauled out during survey time periods. Note that Olesiuk (2018) errored in reporting that 2.1% was the winter CV and 5.6% was the summer CV of the proportion of population hauled out; both should have read SD instead of CV (Personal communication Peter Olesiuk, 2021).”</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>WinSprFallCF <span class="ot">&lt;-</span> <span class="cf">function</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.36</span>,<span class="fl">0.021</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>SummerCF <span class="ot">&lt;-</span> <span class="cf">function</span>()</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.674</span>,<span class="fl">0.056</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="seasonal-demographic-functions-sex-and-age" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="seasonal-demographic-functions-sex-and-age"><span class="header-section-number">2.2.2</span> Seasonal Demographic Functions (Sex and age)</h3>
<p>We assume that relative proportion of demographics has not changed from the initial estimates calculated for the model used in <span class="citation" data-cites="scordino2022">@scordino2022</span>, as demographic counts were not performed for every survey in 2020-2021.</p>
<p>Methods from <span class="citation" data-cites="scordino2022">@scordino2022</span>:</p>
<p>“Count data from Scordino and Akmajian (2021) were used to determine the proportion of the hauled out Steller sea lions that were adult male, adult female, and juvenile.”</p>
<p>Note: In contrast to abundance count data, demographic counts were obtained from all days 2010-2013 that had demographic data, and did not need to have all haulouts surveyed within a day.</p>
<p>Seasonal demographic functions modeled with beta distributions for each season for observed adult female, adult male and juvenile proportions.</p>
<p><strong>Table 2</strong>: Beta distribution parameters for modeling demographic proportions for adult male, adult female and juvenile Steller sea lions along the northwest coast of Washington State. Demographic proportions obtained from <span class="citation" data-cites="scordino2022">@scordino2022</span>, 2010-2013 demographic counts.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Season</th>
<th style="text-align: left;">Avg F</th>
<th style="text-align: left;">Sd F</th>
<th style="text-align: left;">Avg J</th>
<th style="text-align: left;">Sd J</th>
<th style="text-align: left;">Avg M</th>
<th style="text-align: left;">Sd M</th>
<th style="text-align: left;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Spring</td>
<td style="text-align: left;">0.379</td>
<td style="text-align: left;">0.099</td>
<td style="text-align: left;">0.426</td>
<td style="text-align: left;">0.098</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">0.071</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td>Summer</td>
<td style="text-align: left;">0.261</td>
<td style="text-align: left;">0.055</td>
<td style="text-align: left;">0.408</td>
<td style="text-align: left;">0.055</td>
<td style="text-align: left;">0.330</td>
<td style="text-align: left;">0.071</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="odd">
<td>Winter</td>
<td style="text-align: left;">0.390</td>
<td style="text-align: left;">0.104</td>
<td style="text-align: left;">0.406</td>
<td style="text-align: left;">0.046</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">0.074</td>
<td style="text-align: left;">4</td>
</tr>
</tbody>
</table>
<p>The proportions of individuals hauled out of each demographic group is best modeled using a beta distribution. To calculate the beta distribution we first calculated the shape 1 and shape 2 of the distribution for each demographic group by season.”</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>demographics <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">winter =</span> <span class="fu">list</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">juvenile =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.406</span>, <span class="at">sd =</span> <span class="fl">0.046</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">female =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.390</span>, <span class="at">sd =</span> <span class="fl">0.104</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">male =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.205</span>, <span class="at">sd =</span> <span class="fl">0.074</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">spring =</span> <span class="fu">list</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">juvenile =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.426</span>, <span class="at">sd =</span> <span class="fl">0.098</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">female =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.379</span>, <span class="at">sd =</span> <span class="fl">0.099</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">male =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.195</span>, <span class="at">sd =</span> <span class="fl">0.071</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">summer =</span> <span class="fu">list</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">juvenile =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.408</span>, <span class="at">sd =</span> <span class="fl">0.055</span>),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">female =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.261</span>, <span class="at">sd =</span> <span class="fl">0.055</span>),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">male =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fl">0.330</span>, <span class="at">sd =</span> <span class="fl">0.071</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate beta shapes function</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>calc_beta_shapes <span class="ot">&lt;-</span> <span class="cf">function</span>(mean, sd) {</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  shape1 <span class="ot">&lt;-</span> (mean<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> mean<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> mean <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  shape2 <span class="ot">&lt;-</span> (mean <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> mean<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> mean<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> mean <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(shape1, shape2))</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># General function to sample from Beta distribution for a given season and demographic</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>sample_beta_demo <span class="ot">&lt;-</span> <span class="cf">function</span>(season, demo_group) {</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  demo <span class="ot">&lt;-</span> demographics[[season]][[demo_group]]</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">calc_beta_shapes</span>(demo[<span class="st">"mean"</span>], demo[<span class="st">"sd"</span>])</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">shape1 =</span> shapes[<span class="dv">1</span>], <span class="at">shape2 =</span> shapes[<span class="dv">2</span>])</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>WinJuvDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"winter"</span>, <span class="st">"juvenile"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>WinFemDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"winter"</span>, <span class="st">"female"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>WinMaleDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"winter"</span>, <span class="st">"male"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>SprJuvDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"spring"</span>, <span class="st">"juvenile"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>SprFemDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"spring"</span>, <span class="st">"female"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>SprMaleDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"spring"</span>, <span class="st">"male"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>SumJuvDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"summer"</span>, <span class="st">"juvenile"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>SumFemDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"summer"</span>, <span class="st">"female"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>SumMaleDemo <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sample_beta_demo</span>(<span class="st">"summer"</span>, <span class="st">"male"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sex-of-juveniles-ratio" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="sex-of-juveniles-ratio"><span class="header-section-number">2.2.3</span> Sex of juveniles ratio</h3>
<p>Given that Steller sea lion juveniles are not observably different based on sex, we used a known ratio of juvenile female to juvenile male sea lions from previously described in <span class="citation" data-cites="scordino2022">@scordino2022</span>.</p>
<p>Sex ratios were determined from data from <span class="citation" data-cites="wright2017">@wright2017</span>, from cohorts 2001-2007, where survival rates occurred through year 5. Overall sex ratio of juveniles was then determined by averaging survivorship at age for ages 1-5 by each sex.</p>
<p>The proportion of Juvenile sex are as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>PropJuvF <span class="ot">&lt;-</span> <span class="fl">0.544</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>PropJuvM <span class="ot">&lt;-</span> <span class="fl">0.456</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="biomass-calculation" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="biomass-calculation"><span class="header-section-number">2.3</span> Biomass calculation</h2>
<p>Using the above parameters and functions, we can now model the total biomass consumed by Steller sea lions along the northwest Washington coast from December 2020- August 2021.</p>
<section id="biomass-calculation-function" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="biomass-calculation-function"><span class="header-section-number">2.3.1</span> Biomass calculation function</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>calc_biomass <span class="ot">&lt;-</span> <span class="cf">function</span>(abund_func, cf_func, demo_func, prop, ind_daily_cons_func) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replicate</span>(<span class="dv">2000</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abund_func</span>() <span class="sc">*</span> <span class="fu">cf_func</span>() <span class="sc">*</span> <span class="fu">demo_func</span>() <span class="sc">*</span> prop <span class="sc">*</span> <span class="dv">90</span> <span class="sc">*</span> (<span class="fu">ind_daily_cons_func</span>())</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile function for biomass</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>get_biomass_quantiles <span class="ot">&lt;-</span> <span class="cf">function</span>(biomass_data) {</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(biomass_data, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="seasonal-prey-biomass-consumed" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="seasonal-prey-biomass-consumed"><span class="header-section-number">2.3.2</span> Seasonal prey biomass consumed</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Winter</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Spring</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Summer</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Winter Biomass Calculations</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>tot_biomass_WinterJuvF <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(WinAbund, WinSprFallCF, WinJuvDemo, PropJuvF, IndDailyConsumptionJuvF)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>tot_biomass_WinterJuvM <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(WinAbund, WinSprFallCF, WinJuvDemo, PropJuvM, IndDailyConsumptionJuvM)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>tot_biomass_WinterAdF  <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(WinAbund, WinSprFallCF, WinFemDemo, <span class="dv">1</span>, IndDailyConsumptionAdF)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>tot_biomass_WinterAdM  <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(WinAbund, WinSprFallCF, WinMaleDemo, <span class="dv">1</span>, IndDailyConsumptionAdM)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get quantiles for each demographic</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>Win.Juv.F_tot_biomass <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_WinterJuvF)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>Win.Juv.M_tot_biomass <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_WinterJuvM)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>Win.Ad.F_tot_biomass  <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_WinterAdF)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>Win.Ad.M_tot_biomass  <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_WinterAdM)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine quanitiles and format table for presentation in .html </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>win.biomass.demographic <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Win.Juv.F_tot_biomass,Win.Juv.M_tot_biomass,Win.Ad.F_tot_biomass, Win.Ad.M_tot_biomass)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Format table for presentation in .html </span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(win.biomass.demographic) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Juvenile Female"</span>, <span class="st">"Juvenile Male"</span>, <span class="st">"Adult Female"</span>, <span class="st">"Adult Male"</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(win.biomass.demographic, <span class="at">caption=</span> <span class="st">"Winter biomass consumed by demographic (in kg)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Winter biomass consumed by demographic (in kg)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Juvenile Female</th>
<th style="text-align: right;">Juvenile Male</th>
<th style="text-align: right;">Adult Female</th>
<th style="text-align: right;">Adult Male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">663176.1</td>
<td style="text-align: right;">798608.8</td>
<td style="text-align: right;">1579772.8</td>
<td style="text-align: right;">1499520.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">348537.6</td>
<td style="text-align: right;">425317.0</td>
<td style="text-align: right;">738974.9</td>
<td style="text-align: right;">485244.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">1153293.8</td>
<td style="text-align: right;">1412790.6</td>
<td style="text-align: right;">2963063.4</td>
<td style="text-align: right;">3546838.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">522690.0</td>
<td style="text-align: right;">634864.0</td>
<td style="text-align: right;">1215679.4</td>
<td style="text-align: right;">1064118.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">815460.7</td>
<td style="text-align: right;">991432.6</td>
<td style="text-align: right;">1984393.8</td>
<td style="text-align: right;">2031345.0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total biomass for the entire population in metric tons</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Winter_tot_biomass <span class="ot">&lt;-</span> (tot_biomass_WinterJuvF <span class="sc">+</span> tot_biomass_WinterJuvM <span class="sc">+</span> tot_biomass_WinterAdF <span class="sc">+</span> tot_biomass_WinterAdM) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Winter_tot_biomass_sum <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(Winter_tot_biomass)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Winter_tot_biomass_sum, <span class="at">caption =</span> <span class="st">"Total metric tons of prey consumed in winter"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Total metric tons of prey consumed in winter</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">4662.407</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">3045.579</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">7204.893</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">4047.692</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">5375.634</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spring Biomass Calculations</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tot_biomass_SpringJuvF <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SprAbund, WinSprFallCF, SprJuvDemo, PropJuvF, IndDailyConsumptionJuvF)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>tot_biomass_SpringJuvM <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SprAbund, WinSprFallCF, SprJuvDemo, PropJuvM, IndDailyConsumptionJuvM)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>tot_biomass_SpringAdF  <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SprAbund, WinSprFallCF, SprFemDemo, <span class="dv">1</span>, IndDailyConsumptionAdF)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>tot_biomass_SpringAdM  <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SprAbund, WinSprFallCF, SprMaleDemo, <span class="dv">1</span>, IndDailyConsumptionAdM)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get quantiles for each demographic in Spring</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>Spr.Juv.F_tot_biomass <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SpringJuvF)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>Spr.Juv.M_tot_biomass <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SpringJuvM)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>Spr.Ad.F_tot_biomass  <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SpringAdF)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>Spr.Ad.M_tot_biomass  <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SpringAdM)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>spr.biomass.demographic <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Spr.Juv.F_tot_biomass,Spr.Juv.M_tot_biomass,Spr.Ad.F_tot_biomass, Spr.Ad.M_tot_biomass)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(spr.biomass.demographic) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Juvenile Female"</span>, <span class="st">"Juvenile Male"</span>, <span class="st">"Adult Female"</span>, <span class="st">"Adult Male"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(spr.biomass.demographic, <span class="at">caption=</span> <span class="st">"Spring biomass consumed by demographic (in kgs)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Spring biomass consumed by demographic (in kgs)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Juvenile Female</th>
<th style="text-align: right;">Juvenile Male</th>
<th style="text-align: right;">Adult Female</th>
<th style="text-align: right;">Adult Male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">604167.9</td>
<td style="text-align: right;">741817.6</td>
<td style="text-align: right;">1377877.9</td>
<td style="text-align: right;">1291146.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">285658.3</td>
<td style="text-align: right;">339652.8</td>
<td style="text-align: right;">643807.6</td>
<td style="text-align: right;">452040.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">1244713.4</td>
<td style="text-align: right;">1499411.1</td>
<td style="text-align: right;">2618780.8</td>
<td style="text-align: right;">3101562.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">466057.5</td>
<td style="text-align: right;">560612.0</td>
<td style="text-align: right;">1081863.0</td>
<td style="text-align: right;">937109.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">788304.4</td>
<td style="text-align: right;">955472.6</td>
<td style="text-align: right;">1759061.0</td>
<td style="text-align: right;">1800225.1</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total biomass for the entire population in Spring (metric tons)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Spring_tot_biomass <span class="ot">&lt;-</span> (tot_biomass_SpringJuvF <span class="sc">+</span> tot_biomass_SpringJuvM <span class="sc">+</span> tot_biomass_SpringAdF <span class="sc">+</span> tot_biomass_SpringAdM) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Spring_tot_biomass_sum <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(Spring_tot_biomass)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Spring_tot_biomass_sum, <span class="at">caption =</span> <span class="st">"Total metric tons of prey consumed in spring"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Total metric tons of prey consumed in spring</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">4210.135</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">2741.360</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">6424.005</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">3638.938</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">4874.489</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summer Biomass Calculations</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tot_biomass_SummerJuvF <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SumAbund, SummerCF, SumJuvDemo, PropJuvF, IndDailyConsumptionJuvF)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>tot_biomass_SummerJuvM <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SumAbund, SummerCF, SumJuvDemo, PropJuvM, IndDailyConsumptionJuvM)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>tot_biomass_SummerAdF  <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SumAbund, SummerCF, SumFemDemo, <span class="dv">1</span>, IndDailyConsumptionAdF)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>tot_biomass_SummerAdM  <span class="ot">&lt;-</span> <span class="fu">calc_biomass</span>(SumAbund, SummerCF, SumMaleDemo, <span class="dv">1</span>, IndDailyConsumptionAdM)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get quantiles for each demographic in Summer</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>Sum.Juv.F_tot_biomass <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SummerJuvF)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>Sum.Juv.M_tot_biomass <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SummerJuvM)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>Sum.Ad.F_tot_biomass  <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SummerAdF)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>Sum.Ad.M_tot_biomass  <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(tot_biomass_SummerAdM)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>sum.biomass.demographic <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Sum.Juv.F_tot_biomass,Sum.Juv.M_tot_biomass,Sum.Ad.F_tot_biomass, Sum.Ad.M_tot_biomass)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sum.biomass.demographic) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Juvenile Female"</span>, <span class="st">"Juvenile Male"</span>, <span class="st">"Adult Female"</span>, <span class="st">"Adult Male"</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(sum.biomass.demographic, <span class="at">caption=</span> <span class="st">"Summer biomass consumed by demographic (in kgs)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Summer biomass consumed by demographic (in kgs)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Juvenile Female</th>
<th style="text-align: right;">Juvenile Male</th>
<th style="text-align: right;">Adult Female</th>
<th style="text-align: right;">Adult Male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">344167.4</td>
<td style="text-align: right;">420504.8</td>
<td style="text-align: right;">552519.6</td>
<td style="text-align: right;">1319085.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">166891.8</td>
<td style="text-align: right;">202361.8</td>
<td style="text-align: right;">274862.6</td>
<td style="text-align: right;">584880.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">644184.3</td>
<td style="text-align: right;">793212.8</td>
<td style="text-align: right;">1032479.1</td>
<td style="text-align: right;">2757821.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">266417.7</td>
<td style="text-align: right;">328945.1</td>
<td style="text-align: right;">443271.1</td>
<td style="text-align: right;">1010160.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">432675.4</td>
<td style="text-align: right;">536495.2</td>
<td style="text-align: right;">696784.1</td>
<td style="text-align: right;">1741181.3</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total biomass for the entire population in Summer (metric tons)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Summer_tot_biomass <span class="ot">&lt;-</span> (tot_biomass_SummerJuvF <span class="sc">+</span> tot_biomass_SummerJuvM <span class="sc">+</span> tot_biomass_SummerAdF <span class="sc">+</span> tot_biomass_SummerAdM) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Summer_tot_biomass_sum <span class="ot">&lt;-</span> <span class="fu">get_biomass_quantiles</span>(Summer_tot_biomass)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Summer_tot_biomass_sum, <span class="at">caption =</span> <span class="st">"Total metric tons of prey consumed in summer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Total metric tons of prey consumed in summer</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">2730.962</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">1816.435</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">4234.252</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">2348.639</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">3173.062</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="results-total-biomass-metric-tons-consumed" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="results-total-biomass-metric-tons-consumed"><span class="header-section-number">2.4</span> <strong>Results: Total biomass (metric tons) consumed</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>total_biomass <span class="ot">&lt;-</span> (Summer_tot_biomass <span class="sc">+</span> Spring_tot_biomass <span class="sc">+</span> Winter_tot_biomass)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>overall_biomass_consumed <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">quantile</span>(total_biomass,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>)))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(overall_biomass_consumed) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Prey consumed (metric tons)"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>overall_biomass_consumed <span class="ot">&lt;-</span> <span class="fu">apply</span>(overall_biomass_consumed, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">formatC</span>(x, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(overall_biomass_consumed, <span class="at">caption =</span> <span class="st">"Metric tons of prey consumed December-August"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Metric tons of prey consumed December-August</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Prey consumed (metric tons)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: left;">11,801.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: left;">9,228.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: left;">15,004.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: left;">10,825.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: left;">12,923.1</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>total_biomass_seasonal_avg_dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Winter_tot_biomass_sum, Spring_tot_biomass_sum, Summer_tot_biomass_sum) <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>rowname, <span class="at">names_to =</span> <span class="st">"season"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rowname, <span class="at">values_from =</span> value)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>fig4dat <span class="ot">&lt;-</span> total_biomass_seasonal_avg_dat <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg =</span> <span class="st">`</span><span class="at">50%</span><span class="st">`</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_min =</span> <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_max =</span> <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low =</span> <span class="st">`</span><span class="at">25%</span><span class="st">`</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high =</span> <span class="st">`</span><span class="at">75%</span><span class="st">`</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Winter_tot_biomass_sum'</span>, <span class="st">'Spring_tot_biomass_sum'</span>, <span class="st">'Summer_tot_biomass_sum'</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Winter'</span>, <span class="st">'Spring'</span>, <span class="st">'Summer'</span>)))</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>total_biomass_seasonal_avg_dat_formatted <span class="ot">&lt;-</span> total_biomass_seasonal_avg_dat <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">formatC</span>(., <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(total_biomass_seasonal_avg_dat_formatted, <span class="at">caption =</span> <span class="st">"Biomass (in metric tons) consumed by season"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Biomass (in metric tons) consumed by season</caption>
<thead>
<tr class="header">
<th style="text-align: left;">season</th>
<th style="text-align: left;">50%</th>
<th style="text-align: left;">2.5%</th>
<th style="text-align: left;">97.5%</th>
<th style="text-align: left;">25%</th>
<th style="text-align: left;">75%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Winter_tot_biomass_sum</td>
<td style="text-align: left;">4,662.4</td>
<td style="text-align: left;">3,045.6</td>
<td style="text-align: left;">7,204.9</td>
<td style="text-align: left;">4,047.7</td>
<td style="text-align: left;">5,375.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spring_tot_biomass_sum</td>
<td style="text-align: left;">4,210.1</td>
<td style="text-align: left;">2,741.4</td>
<td style="text-align: left;">6,424.0</td>
<td style="text-align: left;">3,638.9</td>
<td style="text-align: left;">4,874.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Summer_tot_biomass_sum</td>
<td style="text-align: left;">2,731.0</td>
<td style="text-align: left;">1,816.4</td>
<td style="text-align: left;">4,234.3</td>
<td style="text-align: left;">2,348.6</td>
<td style="text-align: left;">3,173.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="figure-4-total-biomass-consumed" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="figure-4-total-biomass-consumed"><span class="header-section-number">2.4.1</span> Figure 4: Total Biomass Consumed</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns and factor the seasons</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>seasonorder <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Winter'</span>, <span class="st">'Spring'</span>, <span class="st">'Summer'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>fig4plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>fig4dat, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(season, <span class="at">level=</span> seasonorder), <span class="at">y=</span>avg))<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.5</span>,<span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>fig4dat, <span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max), <span class="at">width =</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>fig4dat, <span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_high), <span class="at">width =</span><span class="fl">0.0</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">linewidth =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"#E2A43B"</span>)<span class="sc">+</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()  <span class="sc">+</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Season'</span>) <span class="sc">+</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Total Biomass of Prey Consumed (metric tons)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig4plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/reformatting%20for%20figure-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure4.pdf"</span>, fig4plot, <span class="at">device =</span> <span class="st">"pdf"</span>, <span class="at">units =</span> <span class="fu">c</span>(<span class="st">"in"</span>), <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="zoib-model-for-chinook-diet-proportions" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> ZOIB model for Chinook Diet Proportions</h1>
<section id="data-setup" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-setup"><span class="header-section-number">3.1</span> Data setup</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>RRAdat <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"model inputs.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Chinook RRA"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>RRAdat<span class="sc">$</span>PRCNT <span class="ot">&lt;-</span> RRAdat<span class="sc">$</span>RRA</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>chinook <span class="ot">&lt;-</span> RRAdat <span class="sc">%&gt;%</span> <span class="fu">select</span>(sample, PRCNT) </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"model inputs.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"metadata"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>model_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(chinook, metadata, <span class="at">all =</span> <span class="cn">TRUE</span>, <span class="at">by.x =</span> <span class="st">"sample"</span>) <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">PRCNT=</span><span class="dv">0</span>))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>model_df<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="st">"ONCTSH"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Define useful variables</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>n_samples<span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(model_df<span class="sc">$</span>sample)) <span class="co"># Number of samples in the datset</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>sample_list<span class="ot">&lt;-</span> <span class="fu">unique</span>(model_df<span class="sc">$</span>sample) <span class="co"># List of sample IDs in dataset</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>target_spp <span class="ot">&lt;-</span> <span class="st">"ONCTSH"</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Build the structure of the model df</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>model_df<span class="sc">$</span>sample<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(model_df<span class="sc">$</span>sample)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>model_df<span class="sc">$</span>site<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(model_df<span class="sc">$</span>site)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>model_df<span class="sc">$</span>season<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(model_df<span class="sc">$</span>season)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-of-sample-diet-proportions-by-season-and-sex" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="plot-of-sample-diet-proportions-by-season-and-sex"><span class="header-section-number">3.2</span> Plot of sample diet proportions, by season and sex</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plot_col<span class="ot">&lt;-</span> <span class="fu">viridis</span>(<span class="dv">5</span>)<span class="co"># Colors</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>site_cols<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Tatoosh Cut"</span><span class="ot">=</span>plot_col[<span class="dv">1</span>], <span class="st">"Sea Lion Rock"</span><span class="ot">=</span>plot_col[<span class="dv">3</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>site_cols_fill<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Tatoosh Cut"</span><span class="ot">=</span><span class="fu">alpha</span>(plot_col[<span class="dv">1</span>], <span class="fl">0.25</span>), <span class="st">"Sea Lion Rock"</span><span class="ot">=</span><span class="fu">alpha</span>(plot_col[<span class="dv">3</span>], <span class="fl">0.25</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>site_labs<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Tatoosh Cut"</span><span class="ot">=</span><span class="st">"Tatoosh Cut"</span>, <span class="st">"Sea Lion Rock"</span><span class="ot">=</span><span class="st">"Sea Lion Rock"</span>) </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>season_labs<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"winter"</span><span class="ot">=</span><span class="st">"Winter"</span>, <span class="st">"spring"</span><span class="ot">=</span><span class="st">"Spring"</span>, <span class="st">"summer"</span><span class="ot">=</span><span class="st">"Summer"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>season_labels_alt<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"W"</span>, <span class="st">"Spr"</span>, <span class="st">"Sum"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Build plot</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>prop_plot1<span class="ot">&lt;-</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(model_df, <span class="fu">aes</span>(<span class="at">x=</span>season, <span class="at">y=</span>PRCNT, <span class="at">fill =</span> site, <span class="at">color =</span> site)) <span class="sc">+</span> </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.25</span>, <span class="at">shape=</span><span class="dv">16</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span>  </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(), <span class="at">trim =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="st">"area"</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Month"</span>, <span class="at">y=</span><span class="st">"Diet proportion"</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> season_labs) <span class="sc">+</span>  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>site_cols_fill) <span class="sc">+</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>site_cols) <span class="sc">+</span> </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sample derived Chinook diet proportions"</span>) <span class="sc">+</span> </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">color=</span><span class="st">"black"</span>,                               <span class="at">face=</span><span class="st">"bold"</span>), <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>), </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.00</span>),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">2.50</span>),</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">1.15</span>, <span class="st">"lines"</span>)) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="cn">NULL</span>), <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="cn">NULL</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>prop_plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(model_df, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> PRCNT)) <span class="sc">+</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span>  </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Combine sites</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Diet proportion"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> season_labs) <span class="sc">+</span>  </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sample derived Chinook diet proportions"</span>) <span class="sc">+</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>), </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>), </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.00</span>),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">2.50</span>),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">1.15</span>, <span class="st">"lines"</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>prop_plot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/chinook%20raw%20data%20plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>prop_plot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/chinook%20raw%20data%20plots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-the-model" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="fit-the-model"><span class="header-section-number">3.3</span> Fit the model</h2>
<p>Here we run 4 MCMC chains on a seasonal model that assumes that the average diet proportion varies by season.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>chains <span class="ot">=</span> <span class="dv">4</span> <span class="co"># Number of MCMC chains to run</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>seasonal<span class="ot">&lt;-</span> <span class="fu">zoib</span>(model_df<span class="sc">$</span>PRCNT <span class="sc">~</span> <span class="fu">as.factor</span>(season)<span class="sc">|</span><span class="dv">1</span><span class="sc">|</span><span class="dv">1</span>, <span class="at">data=</span>model_df, <span class="at">random =</span> <span class="dv">0</span>, <span class="at">EUID=</span>model_df<span class="sc">$</span>sample, <span class="at">joint=</span><span class="cn">FALSE</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.inflation =</span> <span class="cn">TRUE</span>, <span class="at">one.inflation =</span> <span class="cn">FALSE</span>, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">n.iter =</span> <span class="dv">2000</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">n.chain =</span> chains, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">n.thin =</span> <span class="dv">1</span>, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">n.burn =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "***************************************************************************"
[1] "* List of parameter for which the posterior samples are generated         *"
[1] "* b: regression coeff in the linear predictor for the mean of beta dist'n *"
[1] "* d: regression coeff in the linear predictor for the sum of the two      *"
[1] "*    shape parameters in the beta distribution                            *"
[1] "* b0: regression coeff in the linear predictor for Prob(y=0)              *"
[1] "* b1: regression coeff in the linear predictor for Prob(y=1)              *"
[1] "***************************************************************************"
Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 267
   Unobserved stochastic nodes: 18
   Total graph size: 9805

Initializing model

NOTE: Stopping adaptation


[1] "NOTE: in the header of Markov Chain Monte Carlo (MCMC) output of    "
[1] "parameters (coeff), predicted values (ypred), residuals (resid), and"
[1] "standardized residuals (resid.std), *Start, End, Thinning Interval* "
[1] "values are after the initial burning and thinning periods specified "
[1] "by the user. For example, n.iter = 151, n.thin = 2, n.burn=1,       "
[1] "then MCMC header of the *coeff* output would read as follows        "
[1] "--------------------------------------------------------------------"
[1] "Markov Chain Monte Carlo (MCMC) output:"
[1] "Start = 1"
[1] "End = 75"
[1] "Thinning interval = 1"
[1] "--------------------------------------------------------------------"
[1] "                                                                    "
[1] "Coefficients are presented in the order of b, b0 (if zero.inflation=TRUE),"
[1] "b1 (if one.inflation=TRUE), and d. If the names of independent variables X"
[1] "are not shown for the coefficients within each type (b, b0, b1, d), the   "
[1] "first coeffient is always the intercept, followed the coefficients for the"
[1] "X's in the order as how they are entered in the model specification.      "
[1] "--------------------------------------------------------------------------"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>preds_seasonal<span class="ot">&lt;-</span> <span class="fu">rbind</span>(seasonal<span class="sc">$</span>ypred[[<span class="dv">1</span>]], seasonal<span class="sc">$</span>ypred[[<span class="dv">2</span>]], seasonal<span class="sc">$</span>ypred[[<span class="dv">3</span>]], seasonal<span class="sc">$</span>ypred[[<span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="produce-n-samples-from-the-posterior-predictive-distributions-for-each-season" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="produce-n-samples-from-the-posterior-predictive-distributions-for-each-season"><span class="header-section-number">3.4</span> Produce n samples from the posterior predictive distributions, for each season</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n_samples<span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the start of each season in the sample list</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>winter_start <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">row.names</span>(model_df[model_df<span class="sc">$</span>season<span class="sc">==</span><span class="st">"winter"</span>, ]))[<span class="dv">1</span>]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>spring_start<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">row.names</span>(model_df[model_df<span class="sc">$</span>season<span class="sc">==</span><span class="st">"spring"</span>, ]))[<span class="dv">1</span>]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>summer_start<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">row.names</span>(model_df[model_df<span class="sc">$</span>season<span class="sc">==</span><span class="st">"summer"</span>, ]))[<span class="dv">1</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate n samples for each seasonal estimate</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>winter_samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(preds_seasonal[,winter_start], n_samples, <span class="cn">TRUE</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winter_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.01075 0.01942 0.02212 0.02266 0.02552 0.04507 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>spring_samples<span class="ot">&lt;-</span> <span class="fu">sample</span>(preds_seasonal[,spring_start], n_samples, <span class="cn">TRUE</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>summer_samples<span class="ot">&lt;-</span> <span class="fu">sample</span>(preds_seasonal[,summer_start], n_samples, <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-seasonal-diet-proportions-histogram-of-n_samples" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="plot-seasonal-diet-proportions-histogram-of-n_samples"><span class="header-section-number">3.5</span> Plot seasonal diet proportions (histogram of n_samples)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(winter_samples, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>), <span class="at">ann=</span><span class="cn">FALSE</span>, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">col =</span> <span class="fu">alpha</span>(plot_col[<span class="dv">1</span>], <span class="fl">0.50</span>), <span class="at">breaks=</span><span class="dv">15</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>, <span class="at">line=</span><span class="fl">2.0</span>, <span class="st">"Winter"</span>, <span class="at">outer =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(spring_samples, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>), <span class="at">ann=</span><span class="cn">FALSE</span>, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">col =</span> <span class="fu">alpha</span>(plot_col[<span class="dv">2</span>], <span class="fl">0.50</span>), <span class="at">breaks=</span><span class="dv">15</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>, <span class="at">line=</span><span class="fl">2.0</span>, <span class="st">"Spring"</span>, <span class="at">outer =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(summer_samples, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>), <span class="at">ann=</span><span class="cn">FALSE</span>, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">col =</span> <span class="fu">alpha</span>(plot_col[<span class="dv">3</span>], <span class="fl">0.50</span>), <span class="at">breaks=</span><span class="dv">15</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">font=</span><span class="dv">2</span>, <span class="at">line=</span><span class="fl">2.0</span>, <span class="st">"Summer"</span>, <span class="at">outer =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">font=</span><span class="dv">2</span>, <span class="at">line=</span><span class="fl">2.0</span>, <span class="st">"Diet proportion"</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/Plot%20ZOIB%20samples-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="total-chinook-biomass-consumed" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Total Chinook biomass consumed</h1>
<section id="chinook-diet-percentage-from-zoib-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="chinook-diet-percentage-from-zoib-model"><span class="header-section-number">4.1</span> Chinook diet percentage from ZOIB model</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Overall</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Winter</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Spring</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Summer</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>chinprop <span class="ot">&lt;-</span> <span class="fu">cbind</span>(winter_samples, spring_samples, summer_samples)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>chinprop_CI <span class="ot">&lt;-</span> <span class="fu">quantile</span>(chinprop,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(chinprop_CI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">0.0236706</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">0.0108135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">0.0407874</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">0.0197036</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">0.0280933</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>winter_allChinook_proportion <span class="ot">&lt;-</span> <span class="fu">quantile</span>(winter_samples,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>winter_allChinook_proportion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       50%       2.5%      97.5%        25%        75% 
0.02211631 0.01464598 0.03292402 0.01941887 0.02551945 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>spring_allChinook_proportion <span class="ot">&lt;-</span> <span class="fu">quantile</span>(spring_samples,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>spring_allChinook_proportion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       50%       2.5%      97.5%        25%        75% 
0.02601425 0.01798448 0.03771766 0.02266863 0.02938325 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>summer_allChinook_proportion <span class="ot">&lt;-</span> <span class="fu">quantile</span>(summer_samples,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>summer_allChinook_proportion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        50%        2.5%       97.5%         25%         75% 
0.021938956 0.008047071 0.046749348 0.015921937 0.029890109 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="seasonal-consumption-of-chinook-biomass-in-metric-tons" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="seasonal-consumption-of-chinook-biomass-in-metric-tons"><span class="header-section-number">4.2</span> Seasonal consumption of Chinook Biomass (in metric tons)</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Winter</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Spring</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Summer</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>chin_mass_calc <span class="ot">&lt;-</span> <span class="cf">function</span>(tot_biomass, sample_list) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  total_chin <span class="ot">&lt;-</span> tot_biomass <span class="sc">*</span> sample_list</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(total_chin, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_samples =</span> total_chin,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> quantiles)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(result)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">#by demographic</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>Win.Juv.F_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterJuvF, winter_samples)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>Win.Juv.M_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterJuvM, winter_samples)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>Win.Ad.F_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterAdF, winter_samples)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>Win.Ad.M_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterAdM, winter_samples)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total for Winter </span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>Winter_tot_chin <span class="ot">&lt;-</span> (Win.Juv.F_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                    Win.Juv.M_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>                    Win.Ad.F_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                    Win.Ad.M_tot_chin<span class="sc">$</span>total_samples) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>Winter_tot_chin_sum <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Winter_tot_chin, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>Winter_tot_chin_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      50%      2.5%     97.5%       25%       75% 
104.52570  57.82563 182.67035  84.72167 126.88253 </code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#by demographic</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Spr.Juv.F_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringJuvF, spring_samples)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Spr.Juv.M_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringJuvM, spring_samples)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>Spr.Ad.F_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringAdF, spring_samples)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>Spr.Ad.M_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringAdM, spring_samples)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total for spring</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>Spring_tot_chin <span class="ot">&lt;-</span> (Spr.Juv.F_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                    Spr.Juv.M_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                    Spr.Ad.F_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                    Spr.Ad.M_tot_chin<span class="sc">$</span>total_samples) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>Spring_tot_chin_sum <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Spring_tot_chin, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>Spring_tot_chin_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      50%      2.5%     97.5%       25%       75% 
108.98851  62.33049 192.86237  89.31923 132.61647 </code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#by demographic</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Sum.Juv.F_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerJuvF, summer_samples)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>Sum.Juv.M_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerJuvM, summer_samples)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>Sum.Ad.F_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerAdF, summer_samples)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>Sum.Ad.M_tot_chin <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerAdM, summer_samples)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total for summer</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>Summer_tot_chin <span class="ot">&lt;-</span> (Sum.Juv.F_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                    Sum.Juv.M_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                    Sum.Ad.F_tot_chin<span class="sc">$</span>total_samples <span class="sc">+</span> </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                    Sum.Ad.M_tot_chin<span class="sc">$</span>total_samples) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>Summer_tot_chin_sum <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Summer_tot_chin, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>Summer_tot_chin_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      50%      2.5%     97.5%       25%       75% 
 60.06696  21.09241 147.19289  42.34086  83.77083 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="summary-of-chinook-biomass-in-metric-tons-consumed-by-ssl" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="summary-of-chinook-biomass-in-metric-tons-consumed-by-ssl"><span class="header-section-number">4.3</span> Summary of Chinook Biomass (in metric tons) consumed by SSL</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Total_biomass_Chinook <span class="ot">&lt;-</span> (Winter_tot_chin <span class="sc">+</span> Spring_tot_chin <span class="sc">+</span> Summer_tot_chin)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>Total_biomass_Chinook_summary <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Total_biomass_Chinook,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>Total_biomass_Chinook_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     50%     2.5%    97.5%      25%      75% 
283.8751 190.9637 416.8407 248.6139 323.8160 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>tot_chin_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Winter =</span> Winter_tot_chin_sum,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spring =</span> Spring_tot_chin_sum,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Summer =</span> Summer_tot_chin_sum</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list to a data frame</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>biomass_chinook_seasonal_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">names</span>(tot_chin_data), <span class="cf">function</span>(season) {</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">season =</span> season,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg =</span> tot_chin_data[[season]][[<span class="st">"50%"</span>]],</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_min =</span> tot_chin_data[[season]][[<span class="st">"2.5%"</span>]],</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_max =</span> tot_chin_data[[season]][[<span class="st">"97.5%"</span>]],</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_low =</span> tot_chin_data[[season]][[<span class="st">"25%"</span>]],</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_high =</span> tot_chin_data[[season]][[<span class="st">"75%"</span>]]</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>biomass_chinook_seasonal_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  season       avg   ci_min   ci_max   ci_low   ci_high
1 Winter 104.52570 57.82563 182.6703 84.72167 126.88253
2 Spring 108.98851 62.33049 192.8624 89.31923 132.61647
3 Summer  60.06696 21.09241 147.1929 42.34086  83.77083</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(biomass_chinook_seasonal_df, <span class="at">file=</span><span class="st">"code outputs/biomass_allChinook.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="part-4-consumption-of-age-0-chinook" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Part 4: Consumption of Age-0 Chinook</h1>
<section id="adding-uncertainty-around-age-0-proportions" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="adding-uncertainty-around-age-0-proportions"><span class="header-section-number">5.1</span> Adding uncertainty around age-0 proportions</h2>
<p>Here we use a beta distribution to add uncertainty based off of the proportion of age-0 fish per season, and the total number of samples collected each season. Further, we calculate the values used later in the sensitivity analysis.</p>
<section id="age-0-proportion-of-chinook-recovered" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="age-0-proportion-of-chinook-recovered"><span class="header-section-number">5.1.1</span> Age-0 proportion of Chinook recovered</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">winter =</span> <span class="fl">0.58</span>, <span class="at">spring =</span> <span class="fl">0.55</span>, <span class="at">summer =</span> <span class="fl">0.35</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">winter =</span> <span class="dv">29</span>, <span class="at">spring =</span> <span class="dv">18</span>, <span class="at">summer =</span> <span class="dv">17</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define percentage changes for sensitivity analysis</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>percent_changes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to adjust proportions and include original proportions</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>adjust_proportions <span class="ot">&lt;-</span> <span class="cf">function</span>(proportions, percent_changes) {</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame to store the original proportions</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Season =</span> <span class="fu">names</span>(proportions), </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Original_Proportion =</span> proportions)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over each percent change to calculate adjusted proportions</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (change <span class="cf">in</span> percent_changes) {</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate adjusted proportions (Up and Down) and add them to the data frame</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    df[[<span class="fu">paste0</span>(<span class="st">"Change_"</span>, change <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%_Up"</span>)]] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(proportions, <span class="cf">function</span>(prop) prop <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> change))</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    df[[<span class="fu">paste0</span>(<span class="st">"Change_"</span>, change <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%_Down"</span>)]] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(proportions, <span class="cf">function</span>(prop) prop <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> change))</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the data frame with original and adjusted proportions</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function and store the result</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>proportions_df <span class="ot">&lt;-</span> <span class="fu">adjust_proportions</span>(proportions, percent_changes)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to generate samples</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>generate_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(proportion, sample_size, num_samples) {</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> proportion <span class="sc">*</span> (sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> proportion) <span class="sc">*</span> (sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbeta</span>(num_samples, alpha, beta)</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of samples to generate</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate summary statistics</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>calculate_summary_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(samples) {</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  summary_x <span class="ot">&lt;-</span> <span class="fu">summary</span>(samples)</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples)</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">sd</span>(samples) <span class="sc">/</span> mean_x</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Mean =</span> mean_x, <span class="at">SD =</span> <span class="fu">sd</span>(samples), <span class="at">CV =</span> cv, <span class="at">Min =</span> summary_x[[<span class="st">"Min."</span>]], </span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">1st Qu.</span><span class="st">`</span> <span class="ot">=</span> summary_x[[<span class="st">"1st Qu."</span>]], <span class="at">Median =</span> summary_x[[<span class="st">"Median"</span>]], </span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">Mean_Summary =</span> summary_x[[<span class="st">"Mean"</span>]], <span class="st">`</span><span class="at">3rd Qu.</span><span class="st">`</span> <span class="ot">=</span> summary_x[[<span class="st">"3rd Qu."</span>]], </span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">Max =</span> summary_x[[<span class="st">"Max."</span>]])</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize list to store all results and samples</span></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>all_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>all_samples <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each row in the proportions data frame</span></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(proportions_df)) {</span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the season and its sample size</span></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>  season <span class="ot">&lt;-</span> proportions_df<span class="sc">$</span>Season[i]</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> sample_sizes[season]</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over each adjusted proportion (original and adjusted)</span></span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(proportions_df)) {</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>    change_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(proportions_df)[j]</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>    proportion <span class="ot">&lt;-</span> proportions_df[i, j]</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate samples for each adjusted proportion</span></span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">generate_samples</span>(proportion, sample_size, num_samples)</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate summary statistics</span></span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>    summary_stats <span class="ot">&lt;-</span> <span class="fu">calculate_summary_stats</span>(samples)</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results and samples</span></span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>    all_results[[<span class="fu">paste</span>(season, change_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> summary_stats</span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>    all_samples[[<span class="fu">paste</span>(season, change_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> samples</span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a data frame for visualization</span></span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>    samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">Proportion =</span> samples,</span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">Season =</span> season,</span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">Change =</span> change_name</span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the distribution of generated proportions for each season and change</span></span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-83"><a href="#cb52-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect results into a single data frame for comparison</span></span>
<span id="cb52-84"><a href="#cb52-84" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">names</span>(all_results), <span class="cf">function</span>(change_name) {</span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> all_results[[change_name]]</span>
<span id="cb52-86"><a href="#cb52-86" aria-hidden="true" tabindex="-1"></a>  stats_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(stats)  <span class="co"># Convert to a data frame</span></span>
<span id="cb52-87"><a href="#cb52-87" aria-hidden="true" tabindex="-1"></a>  stats_df<span class="sc">$</span>Change <span class="ot">&lt;-</span> change_name</span>
<span id="cb52-88"><a href="#cb52-88" aria-hidden="true" tabindex="-1"></a>  stats_df</span>
<span id="cb52-89"><a href="#cb52-89" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb52-90"><a href="#cb52-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-91"><a href="#cb52-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the cleaned-up results</span></span>
<span id="cb52-92"><a href="#cb52-92" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(results_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">CV</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">X1st.Qu.</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Mean_Summary</th>
<th style="text-align: right;">X3rd.Qu.</th>
<th style="text-align: right;">Max</th>
<th style="text-align: left;">Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5759412</td>
<td style="text-align: right;">0.0884818</td>
<td style="text-align: right;">0.1536300</td>
<td style="text-align: right;">0.2805597</td>
<td style="text-align: right;">0.5147170</td>
<td style="text-align: right;">0.5783026</td>
<td style="text-align: right;">0.5759412</td>
<td style="text-align: right;">0.6365209</td>
<td style="text-align: right;">0.8235865</td>
<td style="text-align: left;">winter_Original_Proportion</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6271548</td>
<td style="text-align: right;">0.0851170</td>
<td style="text-align: right;">0.1357193</td>
<td style="text-align: right;">0.3410082</td>
<td style="text-align: right;">0.5710790</td>
<td style="text-align: right;">0.6301402</td>
<td style="text-align: right;">0.6271548</td>
<td style="text-align: right;">0.6868950</td>
<td style="text-align: right;">0.8754258</td>
<td style="text-align: left;">winter_Change_10%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5202875</td>
<td style="text-align: right;">0.0887910</td>
<td style="text-align: right;">0.1706576</td>
<td style="text-align: right;">0.2337067</td>
<td style="text-align: right;">0.4607228</td>
<td style="text-align: right;">0.5247141</td>
<td style="text-align: right;">0.5202875</td>
<td style="text-align: right;">0.5821158</td>
<td style="text-align: right;">0.8051906</td>
<td style="text-align: left;">winter_Change_10%_Down</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7104992</td>
<td style="text-align: right;">0.0830379</td>
<td style="text-align: right;">0.1168726</td>
<td style="text-align: right;">0.4178292</td>
<td style="text-align: right;">0.6584540</td>
<td style="text-align: right;">0.7184312</td>
<td style="text-align: right;">0.7104992</td>
<td style="text-align: right;">0.7684123</td>
<td style="text-align: right;">0.9100106</td>
<td style="text-align: left;">winter_Change_25%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.4358185</td>
<td style="text-align: right;">0.0901994</td>
<td style="text-align: right;">0.2069656</td>
<td style="text-align: right;">0.1497868</td>
<td style="text-align: right;">0.3752758</td>
<td style="text-align: right;">0.4348468</td>
<td style="text-align: right;">0.4358185</td>
<td style="text-align: right;">0.4993246</td>
<td style="text-align: right;">0.7240605</td>
<td style="text-align: left;">winter_Change_25%_Down</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8470502</td>
<td style="text-align: right;">0.0630390</td>
<td style="text-align: right;">0.0744218</td>
<td style="text-align: right;">0.6065427</td>
<td style="text-align: right;">0.8087048</td>
<td style="text-align: right;">0.8554688</td>
<td style="text-align: right;">0.8470502</td>
<td style="text-align: right;">0.8928972</td>
<td style="text-align: right;">0.9819660</td>
<td style="text-align: left;">winter_Change_50%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3036842</td>
<td style="text-align: right;">0.0827377</td>
<td style="text-align: right;">0.2724466</td>
<td style="text-align: right;">0.0978174</td>
<td style="text-align: right;">0.2449019</td>
<td style="text-align: right;">0.2995372</td>
<td style="text-align: right;">0.3036842</td>
<td style="text-align: right;">0.3569330</td>
<td style="text-align: right;">0.6141475</td>
<td style="text-align: left;">winter_Change_50%_Down</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5493167</td>
<td style="text-align: right;">0.1126790</td>
<td style="text-align: right;">0.2051258</td>
<td style="text-align: right;">0.1777264</td>
<td style="text-align: right;">0.4681386</td>
<td style="text-align: right;">0.5493914</td>
<td style="text-align: right;">0.5493167</td>
<td style="text-align: right;">0.6317549</td>
<td style="text-align: right;">0.8707143</td>
<td style="text-align: left;">spring_Original_Proportion</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5969790</td>
<td style="text-align: right;">0.1088834</td>
<td style="text-align: right;">0.1823907</td>
<td style="text-align: right;">0.2403281</td>
<td style="text-align: right;">0.5191781</td>
<td style="text-align: right;">0.6040302</td>
<td style="text-align: right;">0.5969790</td>
<td style="text-align: right;">0.6770416</td>
<td style="text-align: right;">0.9045386</td>
<td style="text-align: left;">spring_Change_10%_Up</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4988587</td>
<td style="text-align: right;">0.1107899</td>
<td style="text-align: right;">0.2220868</td>
<td style="text-align: right;">0.1453178</td>
<td style="text-align: right;">0.4205852</td>
<td style="text-align: right;">0.4990036</td>
<td style="text-align: right;">0.4988587</td>
<td style="text-align: right;">0.5782400</td>
<td style="text-align: right;">0.8052894</td>
<td style="text-align: left;">spring_Change_10%_Down</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6686455</td>
<td style="text-align: right;">0.1048232</td>
<td style="text-align: right;">0.1567694</td>
<td style="text-align: right;">0.2660242</td>
<td style="text-align: right;">0.6002187</td>
<td style="text-align: right;">0.6749589</td>
<td style="text-align: right;">0.6686455</td>
<td style="text-align: right;">0.7427490</td>
<td style="text-align: right;">0.9580078</td>
<td style="text-align: left;">spring_Change_25%_Up</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4215806</td>
<td style="text-align: right;">0.1117142</td>
<td style="text-align: right;">0.2649889</td>
<td style="text-align: right;">0.0934470</td>
<td style="text-align: right;">0.3432952</td>
<td style="text-align: right;">0.4200399</td>
<td style="text-align: right;">0.4215806</td>
<td style="text-align: right;">0.4960563</td>
<td style="text-align: right;">0.7960277</td>
<td style="text-align: left;">spring_Change_25%_Down</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7935493</td>
<td style="text-align: right;">0.0929259</td>
<td style="text-align: right;">0.1171016</td>
<td style="text-align: right;">0.4032700</td>
<td style="text-align: right;">0.7336664</td>
<td style="text-align: right;">0.8054634</td>
<td style="text-align: right;">0.7935493</td>
<td style="text-align: right;">0.8652723</td>
<td style="text-align: right;">0.9789777</td>
<td style="text-align: left;">spring_Change_50%_Up</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2931433</td>
<td style="text-align: right;">0.0999108</td>
<td style="text-align: right;">0.3408259</td>
<td style="text-align: right;">0.0455226</td>
<td style="text-align: right;">0.2194665</td>
<td style="text-align: right;">0.2851107</td>
<td style="text-align: right;">0.2931433</td>
<td style="text-align: right;">0.3585063</td>
<td style="text-align: right;">0.6376324</td>
<td style="text-align: left;">spring_Change_50%_Down</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3670514</td>
<td style="text-align: right;">0.1080524</td>
<td style="text-align: right;">0.2943795</td>
<td style="text-align: right;">0.0973002</td>
<td style="text-align: right;">0.2873031</td>
<td style="text-align: right;">0.3608424</td>
<td style="text-align: right;">0.3670514</td>
<td style="text-align: right;">0.4392873</td>
<td style="text-align: right;">0.7627430</td>
<td style="text-align: left;">summer_Original_Proportion</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.3995520</td>
<td style="text-align: right;">0.1147437</td>
<td style="text-align: right;">0.2871810</td>
<td style="text-align: right;">0.0855952</td>
<td style="text-align: right;">0.3171567</td>
<td style="text-align: right;">0.3960049</td>
<td style="text-align: right;">0.3995520</td>
<td style="text-align: right;">0.4786475</td>
<td style="text-align: right;">0.8128474</td>
<td style="text-align: left;">summer_Change_10%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3357929</td>
<td style="text-align: right;">0.1095048</td>
<td style="text-align: right;">0.3261081</td>
<td style="text-align: right;">0.0487350</td>
<td style="text-align: right;">0.2553402</td>
<td style="text-align: right;">0.3310785</td>
<td style="text-align: right;">0.3357929</td>
<td style="text-align: right;">0.4078611</td>
<td style="text-align: right;">0.8076106</td>
<td style="text-align: left;">summer_Change_10%_Down</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4433931</td>
<td style="text-align: right;">0.1151506</td>
<td style="text-align: right;">0.2597031</td>
<td style="text-align: right;">0.1179015</td>
<td style="text-align: right;">0.3583264</td>
<td style="text-align: right;">0.4416446</td>
<td style="text-align: right;">0.4433931</td>
<td style="text-align: right;">0.5229063</td>
<td style="text-align: right;">0.7796399</td>
<td style="text-align: left;">summer_Change_25%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.2824880</td>
<td style="text-align: right;">0.1040592</td>
<td style="text-align: right;">0.3683669</td>
<td style="text-align: right;">0.0430646</td>
<td style="text-align: right;">0.2063119</td>
<td style="text-align: right;">0.2752848</td>
<td style="text-align: right;">0.2824880</td>
<td style="text-align: right;">0.3489426</td>
<td style="text-align: right;">0.7235230</td>
<td style="text-align: left;">summer_Change_25%_Down</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5217530</td>
<td style="text-align: right;">0.1138075</td>
<td style="text-align: right;">0.2181253</td>
<td style="text-align: right;">0.1324456</td>
<td style="text-align: right;">0.4445352</td>
<td style="text-align: right;">0.5210218</td>
<td style="text-align: right;">0.5217530</td>
<td style="text-align: right;">0.6032945</td>
<td style="text-align: right;">0.8897513</td>
<td style="text-align: left;">summer_Change_50%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.2127327</td>
<td style="text-align: right;">0.0954005</td>
<td style="text-align: right;">0.4484526</td>
<td style="text-align: right;">0.0156440</td>
<td style="text-align: right;">0.1415857</td>
<td style="text-align: right;">0.2005306</td>
<td style="text-align: right;">0.2127327</td>
<td style="text-align: right;">0.2732303</td>
<td style="text-align: right;">0.6660613</td>
<td style="text-align: left;">summer_Change_50%_Down</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to retrieve generated samples for a specific season and change</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>get_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(season, change_name) {</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  sample_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(season, change_name, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  all_samples[[sample_key]]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a data frame to store all samples for plotting</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a data frame to store all samples for plotting</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>combined_samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a data frame to store means for plotting</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>means_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each row in the proportions data frame</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(proportions_df)) {</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the season and its sample size</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  season <span class="ot">&lt;-</span> proportions_df<span class="sc">$</span>Season[i]</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> sample_sizes[season]</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over each adjusted proportion (original and adjusted)</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(proportions_df)) {</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    change_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(proportions_df)[j]</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    proportion <span class="ot">&lt;-</span> proportions_df[i, j]</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate samples for each adjusted proportion</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">generate_samples</span>(proportion, sample_size, num_samples)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate mean for each group and store it in the means_df</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    mean_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    means_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(means_df, <span class="fu">data.frame</span>(<span class="at">Proportion =</span> mean_value, <span class="at">Season =</span> season, <span class="at">Change =</span> change_name))</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a data frame for visualization and store in the combined data frame</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Proportion =</span> samples,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">Season =</span> season,</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">Change =</span> change_name</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    combined_samples_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(combined_samples_df, samples_df)</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the combined samples for each season with adjustments overlaid</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>plot_combined_overlay <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> Proportion, <span class="at">fill =</span> Change)) <span class="sc">+</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">binwidth =</span> <span class="fl">0.02</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Use 'identity' to overlay histograms</span></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> means_df, <span class="fu">aes</span>(<span class="at">xintercept =</span> Proportion, <span class="at">color =</span> Change), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Add mean lines</span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ratio of Age-0 to Other Aged Fish with Adjustments"</span>,</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Original_Proportion"</span> <span class="ot">=</span> <span class="st">"gray"</span>, </span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_10%_Up"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, </span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_10%_Down"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>, </span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_25%_Up"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, </span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_25%_Down"</span> <span class="ot">=</span> <span class="st">"#d62728"</span>, </span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_50%_Up"</span> <span class="ot">=</span> <span class="st">"#9467bd"</span>, </span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_50%_Down"</span> <span class="ot">=</span> <span class="st">"#8c564b"</span>)) <span class="sc">+</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Original_Proportion"</span> <span class="ot">=</span> <span class="st">"black"</span>, </span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_10%_Up"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, </span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_10%_Down"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>, </span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_25%_Up"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, </span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_25%_Down"</span> <span class="ot">=</span> <span class="st">"#d62728"</span>, </span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_50%_Up"</span> <span class="ot">=</span> <span class="st">"#9467bd"</span>, </span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_50%_Down"</span> <span class="ot">=</span> <span class="st">"#8c564b"</span>)) <span class="sc">+</span>  <span class="co"># Matching colors for mean lines</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Season, <span class="at">ncol =</span> <span class="dv">1</span>)  <span class="co"># Facet by season to create three plots (one for each season)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plot_combined_overlay</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/plot%20ratio%20of%20age-0%20by%20season-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the combined samples with faceting by 'Change'</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out 'Original_Proportion' from the combined samples data frame for the faceted plot</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>faceted_samples_df <span class="ot">&lt;-</span> combined_samples_df[combined_samples_df<span class="sc">$</span>Change <span class="sc">!=</span> <span class="st">"Original_Proportion"</span>, ]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the faceted plot without the "Original_Proportion"</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>plot_combined <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(faceted_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> Proportion, <span class="at">fill =</span> Season)) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ratio of Age-0 to Other Aged Fish for Different Changes"</span>,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"winter"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"spring"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>, <span class="st">"summer"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>)) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Change, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>original_samples_df <span class="ot">&lt;-</span> combined_samples_df[combined_samples_df<span class="sc">$</span>Change <span class="sc">==</span> <span class="st">"Original_Proportion"</span>, ]</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>plot_original <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(original_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> Proportion, <span class="at">fill =</span> Season)) <span class="sc">+</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ratio of Age-0 to Other Aged Fish - Original Proportion"</span>,</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"winter"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"spring"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>, <span class="st">"summer"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>)) <span class="sc">+</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>plot_combined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/by%20percent%20change-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>plot_original</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/by%20percent%20change-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="determining-age-0-diet-proportion-of-total-diet" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="determining-age-0-diet-proportion-of-total-diet"><span class="header-section-number">5.2</span> Determining Age-0 diet proportion of total diet</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original season samples list</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>season_samples <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">winter =</span> winter_samples,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">spring =</span> spring_samples,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">summer =</span> summer_samples</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize list to store all adjusted samples after multiplying by seasonal samples</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>all_adjusted_samples <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each combination of season and proportion change in the all_samples list</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sample_key <span class="cf">in</span> <span class="fu">names</span>(all_samples)) {</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the season and change details from the sample key (e.g., "winter_Change_10%_Up")</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  key_split <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(sample_key, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  season <span class="ot">&lt;-</span> key_split[<span class="dv">1</span>]</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This captures both the percentage change and whether it's "Up" or "Down" (e.g., "Change_10%_Up")</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  change_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(key_split[<span class="dv">2</span>], key_split[<span class="dv">3</span>], key_split[<span class="dv">4</span>], <span class="at">sep =</span> <span class="st">"_"</span>)  </span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Multiply the corresponding samples by the seasonal samples for that season</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  adjusted_samples <span class="ot">&lt;-</span> all_samples[[sample_key]] <span class="sc">*</span> season_samples[[season]]</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the adjusted samples back into the new list</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  all_adjusted_samples[[sample_key]] <span class="ot">&lt;-</span> adjusted_samples</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a combined list to store all samples for each change group across all seasons</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>overall_samples <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine samples across all seasons for each change group</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (change_group <span class="cf">in</span> <span class="fu">unique</span>(<span class="fu">sapply</span>(<span class="fu">names</span>(all_samples), <span class="cf">function</span>(sample_key) {</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>  key_split <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(sample_key, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(key_split[<span class="dv">2</span>], key_split[<span class="dv">3</span>], key_split[<span class="dv">4</span>], <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>}))) {</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Collect samples from all seasons for this change group</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  combined_samples <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">names</span>(all_adjusted_samples), <span class="cf">function</span>(sample_key) {</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">grepl</span>(change_group, sample_key)) {</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(all_adjusted_samples[[sample_key]])</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the combined samples</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>  overall_samples[[change_group]] <span class="ot">&lt;-</span> combined_samples</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to retrieve adjusted samples for a specific season and change</span></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>get_adjusted_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(season, change_name) {</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>  sample_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(season, change_name, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>  all_adjusted_samples[[sample_key]]</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary dataframe for adjusted samples</span></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary dataframe for adjusted samples</span></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>adjusted_samples_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">names</span>(all_adjusted_samples), <span class="cf">function</span>(sample_key) {</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>  key_split <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(sample_key, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>  season <span class="ot">&lt;-</span> key_split[<span class="dv">1</span>]</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Correctly capture the full "Change" (e.g., "Change_10%_Up")</span></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>  change <span class="ot">&lt;-</span> <span class="fu">paste</span>(key_split[<span class="dv">2</span>], key_split[<span class="dv">3</span>], key_split[<span class="dv">4</span>], <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate summary statistics including CI</span></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>  median_val <span class="ot">&lt;-</span> <span class="fu">median</span>(all_adjusted_samples[[sample_key]])</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>  sd_val <span class="ot">&lt;-</span> <span class="fu">sd</span>(all_adjusted_samples[[sample_key]])</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>  ci_95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(all_adjusted_samples[[sample_key]], <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>  ci_50 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(all_adjusted_samples[[sample_key]], <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">Season =</span> season,</span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Change =</span> change,  <span class="co"># Now includes "Up" or "Down"</span></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> median_val,</span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> sd_val,</span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_95_Lower =</span> ci_95[<span class="dv">1</span>],</span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_95_Upper =</span> ci_95[<span class="dv">2</span>],</span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_50_Lower =</span> ci_50[<span class="dv">1</span>],</span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_50_Upper =</span> ci_50[<span class="dv">2</span>]</span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary dataframe for overall samples</span></span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>overall_samples_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">names</span>(overall_samples), <span class="cf">function</span>(change_group) {</span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate summary statistics for the combined overall samples</span></span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a>  median_val <span class="ot">&lt;-</span> <span class="fu">median</span>(overall_samples[[change_group]])</span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>  sd_val <span class="ot">&lt;-</span> <span class="fu">sd</span>(overall_samples[[change_group]])</span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>  ci_95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(overall_samples[[change_group]], <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a>  ci_50 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(overall_samples[[change_group]], <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">Season =</span> <span class="st">"Overall"</span>,</span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">Change =</span> change_group,</span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> median_val,</span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> sd_val,</span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_95_Lower =</span> ci_95[<span class="dv">1</span>],</span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_95_Upper =</span> ci_95[<span class="dv">2</span>],</span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_50_Lower =</span> ci_50[<span class="dv">1</span>],</span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_50_Upper =</span> ci_50[<span class="dv">2</span>]</span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the seasonal and overall dataframes</span></span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a>final_summary_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(adjusted_samples_df, overall_samples_df)</span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final summary dataframe</span></span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(final_summary_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Season</th>
<th style="text-align: left;">Change</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">CI_95_Lower</th>
<th style="text-align: right;">CI_95_Upper</th>
<th style="text-align: right;">CI_50_Lower</th>
<th style="text-align: right;">CI_50_Upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">winter</td>
<td style="text-align: left;">Original_Proportion_NA</td>
<td style="text-align: right;">0.0126561</td>
<td style="text-align: right;">0.0033334</td>
<td style="text-align: right;">0.0076299</td>
<td style="text-align: right;">0.0204667</td>
<td style="text-align: right;">0.0106585</td>
<td style="text-align: right;">0.0149302</td>
</tr>
<tr class="even">
<td style="text-align: left;">winter</td>
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: right;">0.0139475</td>
<td style="text-align: right;">0.0034859</td>
<td style="text-align: right;">0.0083216</td>
<td style="text-align: right;">0.0217733</td>
<td style="text-align: right;">0.0116825</td>
<td style="text-align: right;">0.0163575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">winter</td>
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: right;">0.0114145</td>
<td style="text-align: right;">0.0031213</td>
<td style="text-align: right;">0.0065923</td>
<td style="text-align: right;">0.0186586</td>
<td style="text-align: right;">0.0095523</td>
<td style="text-align: right;">0.0135717</td>
</tr>
<tr class="even">
<td style="text-align: left;">winter</td>
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: right;">0.0156194</td>
<td style="text-align: right;">0.0038558</td>
<td style="text-align: right;">0.0097835</td>
<td style="text-align: right;">0.0247943</td>
<td style="text-align: right;">0.0133013</td>
<td style="text-align: right;">0.0185286</td>
</tr>
<tr class="odd">
<td style="text-align: left;">winter</td>
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: right;">0.0095997</td>
<td style="text-align: right;">0.0028815</td>
<td style="text-align: right;">0.0050806</td>
<td style="text-align: right;">0.0164531</td>
<td style="text-align: right;">0.0078152</td>
<td style="text-align: right;">0.0114861</td>
</tr>
<tr class="even">
<td style="text-align: left;">winter</td>
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: right;">0.0186844</td>
<td style="text-align: right;">0.0042062</td>
<td style="text-align: right;">0.0120711</td>
<td style="text-align: right;">0.0287508</td>
<td style="text-align: right;">0.0162659</td>
<td style="text-align: right;">0.0216251</td>
</tr>
<tr class="odd">
<td style="text-align: left;">winter</td>
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: right;">0.0065700</td>
<td style="text-align: right;">0.0023932</td>
<td style="text-align: right;">0.0030954</td>
<td style="text-align: right;">0.0124543</td>
<td style="text-align: right;">0.0052113</td>
<td style="text-align: right;">0.0082447</td>
</tr>
<tr class="even">
<td style="text-align: left;">spring</td>
<td style="text-align: left;">Original_Proportion_NA</td>
<td style="text-align: right;">0.0139921</td>
<td style="text-align: right;">0.0041498</td>
<td style="text-align: right;">0.0075610</td>
<td style="text-align: right;">0.0238183</td>
<td style="text-align: right;">0.0115355</td>
<td style="text-align: right;">0.0170077</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spring</td>
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: right;">0.0154500</td>
<td style="text-align: right;">0.0042547</td>
<td style="text-align: right;">0.0085293</td>
<td style="text-align: right;">0.0251574</td>
<td style="text-align: right;">0.0127229</td>
<td style="text-align: right;">0.0183479</td>
</tr>
<tr class="even">
<td style="text-align: left;">spring</td>
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: right;">0.0127851</td>
<td style="text-align: right;">0.0038729</td>
<td style="text-align: right;">0.0067537</td>
<td style="text-align: right;">0.0216334</td>
<td style="text-align: right;">0.0103558</td>
<td style="text-align: right;">0.0155071</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spring</td>
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: right;">0.0172296</td>
<td style="text-align: right;">0.0045075</td>
<td style="text-align: right;">0.0101747</td>
<td style="text-align: right;">0.0277546</td>
<td style="text-align: right;">0.0144134</td>
<td style="text-align: right;">0.0203874</td>
</tr>
<tr class="even">
<td style="text-align: left;">spring</td>
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: right;">0.0107184</td>
<td style="text-align: right;">0.0036966</td>
<td style="text-align: right;">0.0050544</td>
<td style="text-align: right;">0.0195166</td>
<td style="text-align: right;">0.0084859</td>
<td style="text-align: right;">0.0133229</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spring</td>
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: right;">0.0205791</td>
<td style="text-align: right;">0.0047569</td>
<td style="text-align: right;">0.0129624</td>
<td style="text-align: right;">0.0313668</td>
<td style="text-align: right;">0.0175673</td>
<td style="text-align: right;">0.0237910</td>
</tr>
<tr class="even">
<td style="text-align: left;">spring</td>
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: right;">0.0073240</td>
<td style="text-align: right;">0.0031121</td>
<td style="text-align: right;">0.0028845</td>
<td style="text-align: right;">0.0149027</td>
<td style="text-align: right;">0.0054990</td>
<td style="text-align: right;">0.0095510</td>
</tr>
<tr class="odd">
<td style="text-align: left;">summer</td>
<td style="text-align: left;">Original_Proportion_NA</td>
<td style="text-align: right;">0.0078728</td>
<td style="text-align: right;">0.0047724</td>
<td style="text-align: right;">0.0022605</td>
<td style="text-align: right;">0.0203085</td>
<td style="text-align: right;">0.0052334</td>
<td style="text-align: right;">0.0109606</td>
</tr>
<tr class="even">
<td style="text-align: left;">summer</td>
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: right;">0.0085328</td>
<td style="text-align: right;">0.0052117</td>
<td style="text-align: right;">0.0026011</td>
<td style="text-align: right;">0.0229095</td>
<td style="text-align: right;">0.0056629</td>
<td style="text-align: right;">0.0119646</td>
</tr>
<tr class="odd">
<td style="text-align: left;">summer</td>
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: right;">0.0071861</td>
<td style="text-align: right;">0.0043541</td>
<td style="text-align: right;">0.0019920</td>
<td style="text-align: right;">0.0189396</td>
<td style="text-align: right;">0.0047123</td>
<td style="text-align: right;">0.0100415</td>
</tr>
<tr class="even">
<td style="text-align: left;">summer</td>
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: right;">0.0094126</td>
<td style="text-align: right;">0.0055258</td>
<td style="text-align: right;">0.0029964</td>
<td style="text-align: right;">0.0244285</td>
<td style="text-align: right;">0.0065003</td>
<td style="text-align: right;">0.0134638</td>
</tr>
<tr class="odd">
<td style="text-align: left;">summer</td>
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: right;">0.0058153</td>
<td style="text-align: right;">0.0040620</td>
<td style="text-align: right;">0.0015246</td>
<td style="text-align: right;">0.0167220</td>
<td style="text-align: right;">0.0038344</td>
<td style="text-align: right;">0.0085888</td>
</tr>
<tr class="even">
<td style="text-align: left;">summer</td>
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: right;">0.0110830</td>
<td style="text-align: right;">0.0062476</td>
<td style="text-align: right;">0.0036911</td>
<td style="text-align: right;">0.0270642</td>
<td style="text-align: right;">0.0078426</td>
<td style="text-align: right;">0.0158575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">summer</td>
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: right;">0.0042570</td>
<td style="text-align: right;">0.0035370</td>
<td style="text-align: right;">0.0009535</td>
<td style="text-align: right;">0.0140963</td>
<td style="text-align: right;">0.0026600</td>
<td style="text-align: right;">0.0065742</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall</td>
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: right;">0.0131284</td>
<td style="text-align: right;">0.0051220</td>
<td style="text-align: right;">0.0035211</td>
<td style="text-align: right;">0.0235111</td>
<td style="text-align: right;">0.0097970</td>
<td style="text-align: right;">0.0164281</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall</td>
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: right;">0.0107946</td>
<td style="text-align: right;">0.0044096</td>
<td style="text-align: right;">0.0028909</td>
<td style="text-align: right;">0.0201177</td>
<td style="text-align: right;">0.0080335</td>
<td style="text-align: right;">0.0137504</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall</td>
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: right;">0.0147766</td>
<td style="text-align: right;">0.0055947</td>
<td style="text-align: right;">0.0041628</td>
<td style="text-align: right;">0.0259564</td>
<td style="text-align: right;">0.0111063</td>
<td style="text-align: right;">0.0184193</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall</td>
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: right;">0.0090145</td>
<td style="text-align: right;">0.0040322</td>
<td style="text-align: right;">0.0022341</td>
<td style="text-align: right;">0.0179841</td>
<td style="text-align: right;">0.0064089</td>
<td style="text-align: right;">0.0116171</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall</td>
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: right;">0.0178161</td>
<td style="text-align: right;">0.0063259</td>
<td style="text-align: right;">0.0050521</td>
<td style="text-align: right;">0.0296840</td>
<td style="text-align: right;">0.0135576</td>
<td style="text-align: right;">0.0216699</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall</td>
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: right;">0.0062243</td>
<td style="text-align: right;">0.0032443</td>
<td style="text-align: right;">0.0014360</td>
<td style="text-align: right;">0.0139831</td>
<td style="text-align: right;">0.0043223</td>
<td style="text-align: right;">0.0083579</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>combined_samples_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">names</span>(all_adjusted_samples), <span class="cf">function</span>(sample_key) {</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  key_split <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(sample_key, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  season <span class="ot">&lt;-</span> key_split[<span class="dv">1</span>]</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  change <span class="ot">&lt;-</span> <span class="fu">paste</span>(key_split[<span class="dv">2</span>], key_split[<span class="dv">3</span>], key_split[<span class="dv">4</span>], <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a dataframe for each set of adjusted samples</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Proportion =</span> all_adjusted_samples[[sample_key]],</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Season =</span> season,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Change =</span> change</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the adjusted_samples_df for the mean lines</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>means_df <span class="ot">&lt;-</span> adjusted_samples_df</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with adjusted data for each season</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>plot_combined_overlay <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> Proportion, <span class="at">fill =</span> Change)) <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">binwidth =</span> <span class="fl">0.001</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Overlay histograms</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proportion Adjustments by Season"</span>,</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Change_10%_Down"</span> <span class="ot">=</span> <span class="st">"#66c2a5"</span>, </span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_10%_Up"</span> <span class="ot">=</span> <span class="st">"#3288bd"</span>, </span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_25%_Down"</span> <span class="ot">=</span> <span class="st">"#abdda4"</span>, </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_25%_Up"</span> <span class="ot">=</span> <span class="st">"#fdae61"</span>, </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_50%_Down"</span> <span class="ot">=</span> <span class="st">"#e6f598"</span>, </span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Change_50%_Up"</span> <span class="ot">=</span> <span class="st">"#d53e4f"</span>, </span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Original_Proportion"</span> <span class="ot">=</span> <span class="st">"#542788"</span>)) <span class="sc">+</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Season, <span class="at">ncol =</span> <span class="dv">1</span>)  <span class="co"># Facet by season</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add mean lines for each group using `means_df`</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>plot_combined_overlay <span class="ot">&lt;-</span> plot_combined_overlay <span class="sc">+</span> </span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> means_df, <span class="fu">aes</span>(<span class="at">xintercept =</span> Mean, <span class="at">color =</span> Change), </span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Change_10%_Down"</span> <span class="ot">=</span> <span class="st">"#66c2a5"</span>, </span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_10%_Up"</span> <span class="ot">=</span> <span class="st">"#3288bd"</span>, </span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_25%_Down"</span> <span class="ot">=</span> <span class="st">"#abdda4"</span>, </span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_25%_Up"</span> <span class="ot">=</span> <span class="st">"#fdae61"</span>, </span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_50%_Down"</span> <span class="ot">=</span> <span class="st">"#e6f598"</span>, </span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Change_50%_Up"</span> <span class="ot">=</span> <span class="st">"#d53e4f"</span>, </span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Original_Proportion"</span> <span class="ot">=</span> <span class="st">"#542788"</span>))  <span class="co"># Match colors to fill</span></span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>plot_combined_overlay</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/plot%20age-0%20sensitivity%20by%20season-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out the "Original_Proportion_NA" if it exists in the adjusted_samples_df</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>faceted_samples_df <span class="ot">&lt;-</span> combined_samples_df[combined_samples_df<span class="sc">$</span>Change <span class="sc">!=</span> <span class="st">"Original_Proportion_NA"</span>, ]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>plot_combined1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(faceted_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> Proportion, <span class="at">fill =</span> Season)) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proportion of Chinook in diet"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"winter"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"spring"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>, <span class="st">"summer"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>)) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Change, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for "Original_Proportion"</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>original_samples_df <span class="ot">&lt;-</span> combined_samples_df[combined_samples_df<span class="sc">$</span>Change <span class="sc">==</span> <span class="st">"Original_Proportion_NA"</span>, ]</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>plot_original2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(original_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> Proportion, <span class="at">fill =</span> Season)) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ratio of Age-0 to Other Aged Fish - Original Proportion"</span>,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"winter"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"spring"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>, <span class="st">"summer"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>)) <span class="sc">+</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>plot_combined1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/plot%20of%20age0%20diet%20comp-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plot_original2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/plot%20of%20age0%20diet%20comp-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>age0_model_df <span class="ot">&lt;-</span> original_samples_df</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>age0_model_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"Age-0"</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>chinprop <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(chinprop)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>chinMODELdf <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(chinprop, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">names_to =</span> <span class="st">"season"</span>, <span class="at">values_to =</span> <span class="st">"PRCNT"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>chinMODELdf<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"All"</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>age0_model_df<span class="sc">$</span>season <span class="ot">&lt;-</span> <span class="fu">factor</span>(age0_model_df<span class="sc">$</span>Season, <span class="at">levels =</span>  <span class="fu">c</span>(<span class="st">'winter'</span>, <span class="st">'spring'</span>, <span class="st">'summer'</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Winter'</span>, <span class="st">'Spring'</span>, <span class="st">'Summer'</span>))</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>chinMODELdf<span class="sc">$</span>season <span class="ot">&lt;-</span> <span class="fu">factor</span>(chinMODELdf<span class="sc">$</span>season, <span class="at">levels =</span>  <span class="fu">c</span>(<span class="st">'winter_samples'</span>, <span class="st">'spring_samples'</span>, <span class="st">'summer_samples'</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Winter'</span>, <span class="st">'Spring'</span>, <span class="st">'Summer'</span>))</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine both data frames into one</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>proportion_df_plot <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  age0_model_df <span class="sc">%&gt;%</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> Proportion, <span class="at">group =</span> <span class="st">"Age-0"</span>),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  chinMODELdf <span class="sc">%&gt;%</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">value =</span> PRCNT)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>proportion_df_plot<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(proportion_df_plot<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"All"</span>, <span class="st">"Age-0"</span>))</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a single ggplot object with facet_wrap</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(proportion_df_plot, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">'lightgrey'</span>) <span class="sc">+</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Data Source"</span>, <span class="at">y =</span> <span class="st">"Chinook Diet proportion (RRA)"</span>) <span class="sc">+</span> </span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">"right"</span>) <span class="sc">+</span>  <span class="co"># Position labels on the right</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> grey) <span class="sc">+</span> </span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold"</span>), </span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">2.5</span>),</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">1.15</span>, <span class="st">"lines"</span>),</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>  <span class="co"># Place facet labels outside the plot area</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure 5.pdf"</span>, combined_plot, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="extract-original-proportion-samples" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="extract-original-proportion-samples"><span class="header-section-number">5.2.1</span> Extract original proportion samples</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>winter_age0_og <span class="ot">&lt;-</span> <span class="fu">get_adjusted_samples</span>(<span class="st">"winter"</span>, <span class="st">"Original_Proportion"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(winter_age0_og,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        50%        2.5%       97.5%         25%         75% 
0.012656063 0.007629945 0.020466682 0.010658510 0.014930163 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>spring_age0_og <span class="ot">&lt;-</span> <span class="fu">get_adjusted_samples</span>(<span class="st">"spring"</span>, <span class="st">"Original_Proportion"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(spring_age0_og,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        50%        2.5%       97.5%         25%         75% 
0.013992139 0.007560992 0.023818254 0.011535508 0.017007699 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>summer_age0_og <span class="ot">&lt;-</span> <span class="fu">get_adjusted_samples</span>(<span class="st">"summer"</span>, <span class="st">"Original_Proportion"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(summer_age0_og,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        50%        2.5%       97.5%         25%         75% 
0.007872765 0.002260526 0.020308524 0.005233420 0.010960578 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>chinprop_age0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(winter_age0_og, spring_age0_og, summer_age0_og)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>chinprop_CI_age0 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(chinprop_age0,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(chinprop_CI_age0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">50%</td>
<td style="text-align: right;">0.0119028</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: right;">0.0033572</td>
</tr>
<tr class="odd">
<td style="text-align: left;">97.5%</td>
<td style="text-align: right;">0.0222882</td>
</tr>
<tr class="even">
<td style="text-align: left;">25%</td>
<td style="text-align: right;">0.0089008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75%</td>
<td style="text-align: right;">0.0150471</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="function-to-calculate-age-0-biomass-metric-tons-for-each-season-and-adjusted-proportion" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Function to calculate age-0 biomass (metric tons) for each season and adjusted proportion</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the adjusted samples</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>adjusted_samples_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame to store the seasonal biomass results</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>seasonal_biomass_samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame to store the total biomass results across all seasons</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>total_biomass_samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate biomass for a given season</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>calculate_biomass <span class="ot">&lt;-</span> <span class="cf">function</span>(season, current_samples) {</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">"winter"</span>) {</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Win.Juv.F_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterJuvF, current_samples)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Win.Juv.M_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterJuvM, current_samples)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Win.Ad.F_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterAdF, current_samples)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Win.Ad.M_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_WinterAdM, current_samples)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total biomass for Winter</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>total_biomass <span class="ot">&lt;-</span> (results<span class="sc">$</span>Win.Juv.F_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Win.Juv.M_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Win.Ad.F_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Win.Ad.M_age0bm<span class="sc">$</span>total_samples) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">"spring"</span>) {</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Spr.Juv.F_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringJuvF, current_samples)</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Spr.Juv.M_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringJuvM, current_samples)</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Spr.Ad.F_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringAdF, current_samples)</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Spr.Ad.M_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SpringAdM, current_samples)</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total biomass for Spring</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>total_biomass <span class="ot">&lt;-</span> (results<span class="sc">$</span>Spr.Juv.F_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Spr.Juv.M_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Spr.Ad.F_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Spr.Ad.M_age0bm<span class="sc">$</span>total_samples) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">"summer"</span>) {</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Sum.Juv.F_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerJuvF, current_samples)</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Sum.Juv.M_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerJuvM, current_samples)</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Sum.Ad.F_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerAdF, current_samples)</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>Sum.Ad.M_age0bm <span class="ot">&lt;-</span> <span class="fu">chin_mass_calc</span>(tot_biomass_SummerAdM, current_samples)</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total biomass for Summer</span></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>total_biomass <span class="ot">&lt;-</span> (results<span class="sc">$</span>Sum.Juv.F_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Sum.Juv.M_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Sum.Ad.F_age0bm<span class="sc">$</span>total_samples <span class="sc">+</span></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>                              results<span class="sc">$</span>Sum.Ad.M_age0bm<span class="sc">$</span>total_samples) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize lists to store results</span></span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>all_demographic_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>seasonal_biomass_samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>total_biomass_samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>total_biomass_across_seasons <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over all generated samples for each season and change</span></span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sample_key <span class="cf">in</span> <span class="fu">names</span>(all_samples)) {</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>  key_parts <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(sample_key, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>  season <span class="ot">&lt;-</span> key_parts[<span class="dv">1</span>]</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>  change_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(key_parts[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">"_"</span>)</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>  current_samples <span class="ot">&lt;-</span> all_samples[[sample_key]]</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">"winter"</span>) {</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a>    adjusted_samples <span class="ot">&lt;-</span> winter_samples <span class="sc">*</span> current_samples</span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">"spring"</span>) {</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a>    adjusted_samples <span class="ot">&lt;-</span> spring_samples <span class="sc">*</span> current_samples</span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">"summer"</span>) {</span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a>    adjusted_samples <span class="ot">&lt;-</span> summer_samples <span class="sc">*</span> current_samples</span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a>  adjusted_samples_list[[sample_key]] <span class="ot">&lt;-</span> adjusted_samples</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform the biomass calculation</span></span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">calculate_biomass</span>(season, adjusted_samples)</span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store all demographic results</span></span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a>  all_demographic_results[[sample_key]] <span class="ot">&lt;-</span> results</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the seasonal biomass</span></span>
<span id="cb72-83"><a href="#cb72-83" aria-hidden="true" tabindex="-1"></a>  seasonal_biomass_samples_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(seasonal_biomass_samples_df, </span>
<span id="cb72-84"><a href="#cb72-84" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">data.frame</span>(<span class="at">Season =</span> season, </span>
<span id="cb72-85"><a href="#cb72-85" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">Change =</span> change_name, </span>
<span id="cb72-86"><a href="#cb72-86" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">Seasonal_Samples =</span> results<span class="sc">$</span>total_biomass))</span>
<span id="cb72-87"><a href="#cb72-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-88"><a href="#cb72-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Accumulate total biomass across seasons</span></span>
<span id="cb72-89"><a href="#cb72-89" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(total_biomass_across_seasons[[change_name]])) {</span>
<span id="cb72-90"><a href="#cb72-90" aria-hidden="true" tabindex="-1"></a>    total_biomass_across_seasons[[change_name]] <span class="ot">&lt;-</span> total_biomass_across_seasons[[change_name]] <span class="sc">+</span> results<span class="sc">$</span>total_biomass</span>
<span id="cb72-91"><a href="#cb72-91" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb72-92"><a href="#cb72-92" aria-hidden="true" tabindex="-1"></a>    total_biomass_across_seasons[[change_name]] <span class="ot">&lt;-</span> results<span class="sc">$</span>total_biomass</span>
<span id="cb72-93"><a href="#cb72-93" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-94"><a href="#cb72-94" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-95"><a href="#cb72-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-96"><a href="#cb72-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert total biomass across seasons list into a data frame</span></span>
<span id="cb72-97"><a href="#cb72-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (change_name <span class="cf">in</span> <span class="fu">names</span>(total_biomass_across_seasons)) {</span>
<span id="cb72-98"><a href="#cb72-98" aria-hidden="true" tabindex="-1"></a>  total_biomass_samples_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(total_biomass_samples_df, </span>
<span id="cb72-99"><a href="#cb72-99" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">data.frame</span>(<span class="at">Change =</span> change_name, </span>
<span id="cb72-100"><a href="#cb72-100" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Total_Samples =</span> total_biomass_across_seasons[[change_name]]))</span>
<span id="cb72-101"><a href="#cb72-101" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-102"><a href="#cb72-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-103"><a href="#cb72-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-104"><a href="#cb72-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the seasonal biomass results</span></span>
<span id="cb72-105"><a href="#cb72-105" aria-hidden="true" tabindex="-1"></a>seasonal_biomass_summary <span class="ot">&lt;-</span> seasonal_biomass_samples_df <span class="sc">%&gt;%</span></span>
<span id="cb72-106"><a href="#cb72-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Season, Change) <span class="sc">%&gt;%</span></span>
<span id="cb72-107"><a href="#cb72-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb72-108"><a href="#cb72-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg =</span> <span class="fu">quantile</span>(Seasonal_Samples, <span class="at">probs =</span> <span class="fl">0.5</span>),</span>
<span id="cb72-109"><a href="#cb72-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_min =</span> <span class="fu">quantile</span>(Seasonal_Samples, <span class="at">probs =</span> <span class="fl">0.025</span>),</span>
<span id="cb72-110"><a href="#cb72-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low =</span> <span class="fu">quantile</span>(Seasonal_Samples, <span class="at">probs =</span> <span class="fl">0.25</span>),</span>
<span id="cb72-111"><a href="#cb72-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high =</span> <span class="fu">quantile</span>(Seasonal_Samples, <span class="at">probs =</span> <span class="fl">0.75</span>),</span>
<span id="cb72-112"><a href="#cb72-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_max =</span> <span class="fu">quantile</span>(Seasonal_Samples, <span class="at">probs =</span> <span class="fl">0.975</span>),</span>
<span id="cb72-113"><a href="#cb72-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb72-114"><a href="#cb72-114" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-115"><a href="#cb72-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-116"><a href="#cb72-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the total biomass results across seasons</span></span>
<span id="cb72-117"><a href="#cb72-117" aria-hidden="true" tabindex="-1"></a>age0_biomass_summary <span class="ot">&lt;-</span> total_biomass_samples_df <span class="sc">%&gt;%</span></span>
<span id="cb72-118"><a href="#cb72-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Change) <span class="sc">%&gt;%</span></span>
<span id="cb72-119"><a href="#cb72-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">quantile</span>(Total_Samples, <span class="at">probs =</span> <span class="fl">0.5</span>),</span>
<span id="cb72-120"><a href="#cb72-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_min =</span> <span class="fu">quantile</span>(Total_Samples, <span class="at">probs =</span> <span class="fl">0.025</span>),</span>
<span id="cb72-121"><a href="#cb72-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low =</span> <span class="fu">quantile</span>(Total_Samples, <span class="at">probs =</span> <span class="fl">0.25</span>),</span>
<span id="cb72-122"><a href="#cb72-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high =</span> <span class="fu">quantile</span>(Total_Samples, <span class="at">probs =</span> <span class="fl">0.75</span>),</span>
<span id="cb72-123"><a href="#cb72-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_max =</span> <span class="fu">quantile</span>(Total_Samples, <span class="at">probs =</span> <span class="fl">0.975</span>),</span>
<span id="cb72-124"><a href="#cb72-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb72-125"><a href="#cb72-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-126"><a href="#cb72-126" aria-hidden="true" tabindex="-1"></a>age0_biomass_summary<span class="sc">$</span>Change_Simplified <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">".*_(Original_Proportion|Change_.*)"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, age0_biomass_summary<span class="sc">$</span>Change)</span>
<span id="cb72-127"><a href="#cb72-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-128"><a href="#cb72-128" aria-hidden="true" tabindex="-1"></a>age0_biomass_summary_seasonal <span class="ot">&lt;-</span> seasonal_biomass_summary <span class="sc">%&gt;%</span></span>
<span id="cb72-129"><a href="#cb72-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Change_Simplified =</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, Change),</span>
<span id="cb72-130"><a href="#cb72-130" aria-hidden="true" tabindex="-1"></a>         <span class="at">Change_Simplified =</span> <span class="fu">gsub</span>(<span class="st">"Change"</span>, <span class="st">""</span>, Change),</span>
<span id="cb72-131"><a href="#cb72-131" aria-hidden="true" tabindex="-1"></a>         <span class="at">Change_Simplified =</span> <span class="fu">gsub</span>(<span class="st">"Up"</span>, <span class="st">"Increase"</span>, Change),</span>
<span id="cb72-132"><a href="#cb72-132" aria-hidden="true" tabindex="-1"></a>         <span class="at">Change_Simplified =</span> <span class="fu">gsub</span>(<span class="st">"Down"</span>, <span class="st">"Decrease"</span>, Change),</span>
<span id="cb72-133"><a href="#cb72-133" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Convert Season to a factor with specified levels to ensure order</span></span>
<span id="cb72-134"><a href="#cb72-134" aria-hidden="true" tabindex="-1"></a>         <span class="at">Season =</span> <span class="fu">factor</span>(Season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"winter"</span>, <span class="st">"spring"</span>, <span class="st">"summer"</span>)))</span>
<span id="cb72-135"><a href="#cb72-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-136"><a href="#cb72-136" aria-hidden="true" tabindex="-1"></a>changes_df <span class="ot">&lt;-</span> age0_biomass_summary_seasonal <span class="sc">%&gt;%</span></span>
<span id="cb72-137"><a href="#cb72-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Original_Proportion"</span>, Change_Simplified))</span>
<span id="cb72-138"><a href="#cb72-138" aria-hidden="true" tabindex="-1"></a>original_proportions_df <span class="ot">&lt;-</span> age0_biomass_summary_seasonal <span class="sc">%&gt;%</span></span>
<span id="cb72-139"><a href="#cb72-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Original_Proportion"</span>, Change_Simplified)) <span class="sc">%&gt;%</span></span>
<span id="cb72-140"><a href="#cb72-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb72-141"><a href="#cb72-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">Season =</span> <span class="fu">recode</span>(Season, <span class="st">"winter"</span> <span class="ot">=</span> <span class="st">"Winter"</span>, <span class="st">"spring"</span> <span class="ot">=</span> <span class="st">"Spring"</span>, <span class="st">"summer"</span> <span class="ot">=</span> <span class="st">"Summer"</span>))</span>
<span id="cb72-142"><a href="#cb72-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-143"><a href="#cb72-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-144"><a href="#cb72-144" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(age0_biomass_summary, <span class="at">label =</span> <span class="st">"Age-0 Chinook Biomass Consumed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Change</th>
<th style="text-align: right;">avg</th>
<th style="text-align: right;">ci_min</th>
<th style="text-align: right;">ci_low</th>
<th style="text-align: right;">ci_high</th>
<th style="text-align: right;">ci_max</th>
<th style="text-align: left;">Change_Simplified</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: right;">132.77307</td>
<td style="text-align: right;">82.95726</td>
<td style="text-align: right;">112.70103</td>
<td style="text-align: right;">154.8500</td>
<td style="text-align: right;">201.2176</td>
<td style="text-align: left;">Change_10%_Down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: right;">160.95083</td>
<td style="text-align: right;">102.90687</td>
<td style="text-align: right;">136.99523</td>
<td style="text-align: right;">184.8805</td>
<td style="text-align: right;">241.5477</td>
<td style="text-align: left;">Change_10%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: right;">111.22902</td>
<td style="text-align: right;">67.20297</td>
<td style="text-align: right;">93.00681</td>
<td style="text-align: right;">131.2669</td>
<td style="text-align: right;">175.8669</td>
<td style="text-align: left;">Change_25%_Down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: right;">178.33768</td>
<td style="text-align: right;">115.63585</td>
<td style="text-align: right;">154.02168</td>
<td style="text-align: right;">208.1571</td>
<td style="text-align: right;">270.6401</td>
<td style="text-align: left;">Change_25%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: right;">77.42054</td>
<td style="text-align: right;">44.35987</td>
<td style="text-align: right;">63.83231</td>
<td style="text-align: right;">94.6785</td>
<td style="text-align: right;">132.5241</td>
<td style="text-align: left;">Change_50%_Down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: right;">213.34332</td>
<td style="text-align: right;">142.34276</td>
<td style="text-align: right;">185.73457</td>
<td style="text-align: right;">243.9776</td>
<td style="text-align: right;">315.1434</td>
<td style="text-align: left;">Change_50%_Up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: right;">145.60883</td>
<td style="text-align: right;">92.91933</td>
<td style="text-align: right;">125.58204</td>
<td style="text-align: right;">169.1636</td>
<td style="text-align: right;">221.4922</td>
<td style="text-align: left;">Original_Proportion</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the changes (excluding original proportions) with facet_wrap</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>change_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(changes_df, <span class="fu">aes</span>(<span class="at">x =</span> Season, <span class="at">y =</span> avg)) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_high), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Biomass of Prey Consumed by Season (Excluding Original Proportions)"</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Season"</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Biomass of Prey Consumed (metric tons)"</span>) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Change_Simplified, <span class="at">scales =</span> <span class="st">"fixed"</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>change_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/sensitivity%20of%20age-0%20biomass%20plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot only the original proportions</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>original_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(original_proportions_df, <span class="fu">aes</span>(<span class="at">x =</span> Season, <span class="at">y =</span> avg)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add larger confidence interval (ci_min and ci_max)</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add smaller confidence interval (ci_low and ci_high)</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_high), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Biomass of Prey Consumed - Original Proportions"</span>,</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Season"</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Biomass of Prey Consumed (metric tons)"</span>) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the original proportions plot</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>original_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/sensitivity%20of%20age-0%20biomass%20plot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(original_proportions_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 21%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Season</th>
<th style="text-align: left;">Change</th>
<th style="text-align: right;">avg</th>
<th style="text-align: right;">ci_min</th>
<th style="text-align: right;">ci_low</th>
<th style="text-align: right;">ci_high</th>
<th style="text-align: right;">ci_max</th>
<th style="text-align: left;">Change_Simplified</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Spring</td>
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: right;">59.05771</td>
<td style="text-align: right;">27.910400</td>
<td style="text-align: right;">46.42706</td>
<td style="text-align: right;">74.67560</td>
<td style="text-align: right;">117.68289</td>
<td style="text-align: left;">Original_Proportion</td>
</tr>
<tr class="even">
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: right;">21.11630</td>
<td style="text-align: right;">6.083893</td>
<td style="text-align: right;">13.80951</td>
<td style="text-align: right;">31.61608</td>
<td style="text-align: right;">60.44546</td>
<td style="text-align: left;">Original_Proportion</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Winter</td>
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: right;">59.17270</td>
<td style="text-align: right;">30.990796</td>
<td style="text-align: right;">47.56187</td>
<td style="text-align: right;">73.48568</td>
<td style="text-align: right;">111.99770</td>
<td style="text-align: left;">Original_Proportion</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="figure-6-total-chinook-consumed-relative-to-age-0-consumed" class="level3" data-number="6.0.1">
<h3 data-number="6.0.1" class="anchored" data-anchor-id="figure-6-total-chinook-consumed-relative-to-age-0-consumed"><span class="header-section-number">6.0.1</span> Figure 6: Total chinook consumed relative to age-0 consumed</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>allChin <span class="ot">&lt;-</span> biomass_chinook_seasonal_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, avg, ci_min, ci_max, ci_low, ci_high)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>original_proportions_df<span class="sc">$</span>season <span class="ot">&lt;-</span> original_proportions_df<span class="sc">$</span>Season</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>age0chin <span class="ot">&lt;-</span> original_proportions_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, avg, ci_min, ci_max, ci_low, ci_high)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>allChin<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"all"</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>age0chin<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="st">"juv"</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>fig6dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(allChin, age0chin) </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>fig6dat<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(fig6dat<span class="sc">$</span>group, <span class="at">levels =</span>  <span class="fu">c</span>(<span class="st">'all'</span>, <span class="st">'juv'</span>), </span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Chinook'</span>, <span class="st">'Age-0 Chinook'</span>))</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>fig6plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>fig6dat, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(season, <span class="at">level=</span> seasonorder), <span class="at">y=</span>avg, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> group), <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"snow4"</span>,<span class="st">"snow1"</span>), <span class="at">name =</span> <span class="st">"Age-class"</span>) <span class="sc">+</span> </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>fig6dat, <span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max), <span class="at">width =</span><span class="fl">0.1</span>,  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>))<span class="sc">+</span> </span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>fig6dat, <span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_high), <span class="at">width =</span><span class="fl">0.0</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">'#55AFBD'</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()  <span class="sc">+</span>  </span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Season'</span>) <span class="sc">+</span> </span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Biomass of Chinook Consumed (metric tons)'</span>)</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>fig6plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/figure%206%20biomass%20plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure6.pdf"</span>, fig6plot, <span class="at">units =</span> <span class="fu">c</span>(<span class="st">"in"</span>), <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>fig4dat_clean <span class="ot">&lt;-</span> fig4dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">'season'</span>,<span class="st">'avg'</span>,<span class="st">'ci_min'</span>,<span class="st">'ci_max'</span>,<span class="st">'ci_low'</span>, <span class="st">'ci_high'</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"Total Prey"</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>biomass_plot <span class="ot">&lt;-</span> <span class="fu">rbind</span>(fig4dat_clean, fig6dat)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>biomass_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>biomass_plot, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(season, <span class="at">level=</span> seasonorder), <span class="at">y=</span>avg, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>,<span class="st">"gray66"</span>,<span class="st">"lightgray"</span>), <span class="at">name =</span> <span class="st">"Age-class"</span>) <span class="sc">+</span> </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>biomass_plot, <span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max), <span class="at">width =</span><span class="fl">0.1</span>,  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>))<span class="sc">+</span> </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>biomass_plot, <span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_high), <span class="at">width =</span><span class="fl">0.0</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">'#55AFBD'</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()  <span class="sc">+</span>  </span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Season'</span>) <span class="sc">+</span> </span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Biomass of Chinook Consumed (metric tons)'</span>)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>biomass_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/figure%206%20biomass%20plot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bootstrapping" class="level3" data-number="6.0.2">
<h3 data-number="6.0.2" class="anchored" data-anchor-id="bootstrapping"><span class="header-section-number">6.0.2</span> Bootstrapping</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to run bootstrap analysis for a given original distribution and a comparison</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to run bootstrap analysis for a given original distribution and a comparison</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>run_bootstrap_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(original_dist, change_dist, <span class="at">n_sims =</span> <span class="dv">2000</span>) {</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate observed difference</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  dist_2<span class="ot">&lt;-</span> <span class="fu">log</span>(original_dist)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  dist_1<span class="ot">&lt;-</span> <span class="fu">log</span>(change_dist)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  n_samples<span class="ot">&lt;-</span> <span class="fu">length</span>(dist_1)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  observed_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(dist_1) <span class="sc">-</span> <span class="fu">mean</span>(dist_2)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># All data</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(dist_1, dist_2)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize parameters for bootstrapping</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(dist_1)  <span class="co"># Size of each resample (same as original datasets)</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sims)  <span class="co"># Vector to store resampled differences</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bootstrap resampling</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sims) {</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined, <span class="fu">length</span>(combined), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>    dist_1_resample <span class="ot">&lt;-</span> shuffled[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    dist_2_resample <span class="ot">&lt;-</span> shuffled[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> n)]</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>    diffs[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(dist_1_resample) <span class="sc">-</span> <span class="fu">mean</span>(dist_2_resample)</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the p-value</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(diffs) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_diff))</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return observed difference and p-value</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">observed_diff =</span> observed_diff, <span class="at">p_value =</span> p_value))</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize empty data frame to store results</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>age0_biomass_bootresults <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Change_Comparison =</span> <span class="fu">character</span>(), <span class="at">Observed_Difference =</span> <span class="fu">numeric</span>(), <span class="at">P_Value =</span> <span class="fu">numeric</span>(), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the original proportion samples</span></span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>original_dist <span class="ot">&lt;-</span> total_biomass_samples_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Change <span class="sc">==</span> <span class="st">"Original_Proportion"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Total_Samples)</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a><span class="co"># List of changes to compare against the original</span></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>changes_to_compare <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Change_10%_Up"</span>, <span class="st">"Change_10%_Down"</span>, <span class="st">"Change_25%_Up"</span>, <span class="st">"Change_25%_Down"</span>, <span class="st">"Change_50%_Up"</span>, <span class="st">"Change_50%_Down"</span>)</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each change and run the bootstrap analysis</span></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (change <span class="cf">in</span> changes_to_compare) {</span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>  comparison_dist <span class="ot">&lt;-</span> total_biomass_samples_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Change <span class="sc">==</span> change) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Total_Samples)</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the comparison_dist is empty</span></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(comparison_dist) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No data for"</span>, change, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run the bootstrap analysis</span></span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">run_bootstrap_analysis</span>(original_dist, comparison_dist)</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the result to the data frame</span></span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>    age0_biomass_bootresults <span class="ot">&lt;-</span> <span class="fu">rbind</span>(age0_biomass_bootresults, <span class="fu">data.frame</span>(<span class="at">Change_Comparison =</span> change,</span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Observed_Difference =</span> result[<span class="st">'observed_diff'</span>],</span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">P_Value =</span> result[<span class="st">'p_value'</span>]))</span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a>age0_biomass_bootresults<span class="sc">$</span>inverse_log_values <span class="ot">&lt;-</span> <span class="fu">exp</span>(age0_biomass_bootresults<span class="sc">$</span>Observed_Difference)</span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a>age0_biomass_bootresults<span class="sc">$</span>percent_change <span class="ot">&lt;-</span> (age0_biomass_bootresults<span class="sc">$</span>inverse_log_values<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a>age0_biomass_bootresults<span class="sc">$</span>base_age0avg <span class="ot">&lt;-</span> age0_biomass_summary <span class="sc">%&gt;%</span></span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Change <span class="sc">==</span> <span class="st">"Original_Proportion"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(avg)</span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a>age0_biomass_bootresults<span class="sc">$</span>expected_value <span class="ot">&lt;-</span> age0_biomass_bootresults<span class="sc">$</span>base_age0avg <span class="sc">*</span> age0_biomass_bootresults<span class="sc">$</span>inverse_log_values</span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a>age0_biomass_median <span class="ot">&lt;-</span> age0_biomass_summary <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Median =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(avg, <span class="dv">1</span>), <span class="st">" ("</span>, <span class="fu">round</span>(ci_min, <span class="dv">1</span>), <span class="st">"-"</span>, <span class="fu">round</span>(ci_max, <span class="dv">1</span>), <span class="st">")"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"Change_Comparison"</span> <span class="ot">=</span> <span class="st">"Change"</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Change_Comparison, Median)</span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a>age0_biomass_bootresults_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(age0_biomass_median, age0_biomass_bootresults, <span class="at">by =</span> <span class="st">"Change_Comparison"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(age0_biomass_bootresults_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Change_Comparison</th>
<th style="text-align: left;">Median</th>
<th style="text-align: right;">Observed_Difference</th>
<th style="text-align: right;">P_Value</th>
<th style="text-align: right;">inverse_log_values</th>
<th style="text-align: right;">percent_change</th>
<th style="text-align: right;">base_age0avg</th>
<th style="text-align: right;">expected_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: left;">132.8 (83-201.2)</td>
<td style="text-align: right;">-0.0986175</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9060892</td>
<td style="text-align: right;">-9.391076</td>
<td style="text-align: right;">145.6088</td>
<td style="text-align: right;">131.93459</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: left;">161 (102.9-241.5)</td>
<td style="text-align: right;">0.0878051</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.0917753</td>
<td style="text-align: right;">9.177527</td>
<td style="text-align: right;">145.6088</td>
<td style="text-align: right;">158.97212</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: left;">111.2 (67.2-175.9)</td>
<td style="text-align: right;">-0.2741652</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.7602065</td>
<td style="text-align: right;">-23.979349</td>
<td style="text-align: right;">145.6088</td>
<td style="text-align: right;">110.69278</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: left;">178.3 (115.6-270.6)</td>
<td style="text-align: right;">0.2053295</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.2279295</td>
<td style="text-align: right;">22.792954</td>
<td style="text-align: right;">145.6088</td>
<td style="text-align: right;">178.79738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: left;">77.4 (44.4-132.5)</td>
<td style="text-align: right;">-0.6317558</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5316575</td>
<td style="text-align: right;">-46.834252</td>
<td style="text-align: right;">145.6088</td>
<td style="text-align: right;">77.41402</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: left;">213.3 (142.3-315.1)</td>
<td style="text-align: right;">0.3793932</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.4613975</td>
<td style="text-align: right;">46.139755</td>
<td style="text-align: right;">145.6088</td>
<td style="text-align: right;">212.79239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: left;">145.6 (92.9-221.5)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>age0_biomass_summary<span class="sc">$</span>Change <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  age0_biomass_summary<span class="sc">$</span>Change,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Original_Proportion"</span>, <span class="st">"Change_10%_Down"</span>, <span class="st">"Change_10%_Up"</span>, <span class="st">"Change_25%_Down"</span>, <span class="st">"Change_25%_Up"</span>,<span class="st">"Change_50%_Down"</span>, <span class="st">"Change_50%_Up"</span>),  <span class="co"># Specify the original order</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Base Model"</span>, <span class="st">"10% Decrease"</span>, <span class="st">"10% Increase"</span>, <span class="st">"25% Decrease"</span>, <span class="st">"25% Increase"</span>,<span class="st">"50% Decrease"</span>, <span class="st">"50% Increase"</span>)  <span class="co"># Specify the new labels</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>age0_biomass_plot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(age0_biomass_summary, <span class="fu">aes</span>(<span class="at">x =</span> Change, <span class="at">y =</span> <span class="st">`</span><span class="at">avg</span><span class="st">`</span>, <span class="at">fill =</span> Change)) <span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="st">`</span><span class="at">ci_min</span><span class="st">`</span>, <span class="at">ymax =</span> <span class="st">`</span><span class="at">ci_max</span><span class="st">`</span>), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="st">`</span><span class="at">ci_low</span><span class="st">`</span>, <span class="at">ymax =</span> <span class="st">`</span><span class="at">ci_high</span><span class="st">`</span>), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"#55AFBD"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Biomass consumed (metric tons)"</span>, </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Change Type"</span>) <span class="sc">+</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>age0_biomass_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/biomass%20plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure8.pdf"</span>, <span class="at">plot =</span> age0_biomass_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="number-of-age-0-chinook-consumed" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="number-of-age-0-chinook-consumed"><span class="header-section-number">6.1</span> Number of Age-0 Chinook consumed</h2>
<section id="weight-of-chinook-salmon" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="weight-of-chinook-salmon"><span class="header-section-number">6.1.1</span> Weight of Chinook salmon</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Length functions for each month</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>DecJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">236.9987</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>JanJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">175.436</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>FebJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">170.2746</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>MarJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">201.9993</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>AprJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">234.8554</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>MayJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">173.6663</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>JunJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">142.0207</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>JulJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">133.1082</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>AugJuvChinLength <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rlnormTrunc</span>(<span class="dv">1</span>, <span class="fu">log</span>(<span class="fl">151.4996</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Weight functions using lengths</span></span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>DecJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">DecJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a>JanJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">JanJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a>FebJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">FebJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-54"><a href="#cb81-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-55"><a href="#cb81-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-56"><a href="#cb81-56" aria-hidden="true" tabindex="-1"></a>MarJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-57"><a href="#cb81-57" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">MarJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-58"><a href="#cb81-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-59"><a href="#cb81-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-60"><a href="#cb81-60" aria-hidden="true" tabindex="-1"></a>AprJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-61"><a href="#cb81-61" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">AprJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-62"><a href="#cb81-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-63"><a href="#cb81-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-64"><a href="#cb81-64" aria-hidden="true" tabindex="-1"></a>MayJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-65"><a href="#cb81-65" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">MayJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-66"><a href="#cb81-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-67"><a href="#cb81-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-68"><a href="#cb81-68" aria-hidden="true" tabindex="-1"></a>JunJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-69"><a href="#cb81-69" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">JunJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-70"><a href="#cb81-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-71"><a href="#cb81-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-72"><a href="#cb81-72" aria-hidden="true" tabindex="-1"></a>JulJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-73"><a href="#cb81-73" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">JulJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-74"><a href="#cb81-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-75"><a href="#cb81-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-76"><a href="#cb81-76" aria-hidden="true" tabindex="-1"></a>AugJuvChinWt <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb81-77"><a href="#cb81-77" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">9.61</span> <span class="sc">*</span> ((<span class="fu">AugJuvChinLength</span>() <span class="sc">/</span> <span class="dv">10</span>)<span class="sc">^</span><span class="fl">3.07</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb81-78"><a href="#cb81-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-79"><a href="#cb81-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-80"><a href="#cb81-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate length and weight samples for each month</span></span>
<span id="cb81-81"><a href="#cb81-81" aria-hidden="true" tabindex="-1"></a>length_samples_Dec <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">DecJuvChinLength</span>())</span>
<span id="cb81-82"><a href="#cb81-82" aria-hidden="true" tabindex="-1"></a>weight_samples_Dec <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">DecJuvChinWt</span>())</span>
<span id="cb81-83"><a href="#cb81-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-84"><a href="#cb81-84" aria-hidden="true" tabindex="-1"></a>length_samples_Jan <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">JanJuvChinLength</span>())</span>
<span id="cb81-85"><a href="#cb81-85" aria-hidden="true" tabindex="-1"></a>weight_samples_Jan <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">JanJuvChinWt</span>())</span>
<span id="cb81-86"><a href="#cb81-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-87"><a href="#cb81-87" aria-hidden="true" tabindex="-1"></a>length_samples_Feb <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">FebJuvChinLength</span>())</span>
<span id="cb81-88"><a href="#cb81-88" aria-hidden="true" tabindex="-1"></a>weight_samples_Feb <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">FebJuvChinWt</span>())</span>
<span id="cb81-89"><a href="#cb81-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-90"><a href="#cb81-90" aria-hidden="true" tabindex="-1"></a>length_samples_Mar <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">MarJuvChinLength</span>())</span>
<span id="cb81-91"><a href="#cb81-91" aria-hidden="true" tabindex="-1"></a>weight_samples_Mar <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">MarJuvChinWt</span>())</span>
<span id="cb81-92"><a href="#cb81-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-93"><a href="#cb81-93" aria-hidden="true" tabindex="-1"></a>length_samples_Apr <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">AprJuvChinLength</span>())</span>
<span id="cb81-94"><a href="#cb81-94" aria-hidden="true" tabindex="-1"></a>weight_samples_Apr <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">AprJuvChinWt</span>())</span>
<span id="cb81-95"><a href="#cb81-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-96"><a href="#cb81-96" aria-hidden="true" tabindex="-1"></a>length_samples_May <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">MayJuvChinLength</span>())</span>
<span id="cb81-97"><a href="#cb81-97" aria-hidden="true" tabindex="-1"></a>weight_samples_May <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">MayJuvChinWt</span>())</span>
<span id="cb81-98"><a href="#cb81-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-99"><a href="#cb81-99" aria-hidden="true" tabindex="-1"></a>length_samples_Jun <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">JunJuvChinLength</span>())</span>
<span id="cb81-100"><a href="#cb81-100" aria-hidden="true" tabindex="-1"></a>weight_samples_Jun <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">JunJuvChinWt</span>())</span>
<span id="cb81-101"><a href="#cb81-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-102"><a href="#cb81-102" aria-hidden="true" tabindex="-1"></a>length_samples_Jul <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">JulJuvChinLength</span>())</span>
<span id="cb81-103"><a href="#cb81-103" aria-hidden="true" tabindex="-1"></a>weight_samples_Jul <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">JulJuvChinWt</span>())</span>
<span id="cb81-104"><a href="#cb81-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-105"><a href="#cb81-105" aria-hidden="true" tabindex="-1"></a>length_samples_Aug <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">AugJuvChinLength</span>())</span>
<span id="cb81-106"><a href="#cb81-106" aria-hidden="true" tabindex="-1"></a>weight_samples_Aug <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">AugJuvChinWt</span>())</span>
<span id="cb81-107"><a href="#cb81-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-108"><a href="#cb81-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine length samples into a data frame</span></span>
<span id="cb81-109"><a href="#cb81-109" aria-hidden="true" tabindex="-1"></a>length_samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-110"><a href="#cb81-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">month =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"December"</span>, <span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>), <span class="at">each =</span> <span class="dv">2000</span>),</span>
<span id="cb81-111"><a href="#cb81-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">length_value =</span> <span class="fu">c</span>(length_samples_Dec, length_samples_Jan, length_samples_Feb, length_samples_Mar, </span>
<span id="cb81-112"><a href="#cb81-112" aria-hidden="true" tabindex="-1"></a>                   length_samples_Apr, length_samples_May, length_samples_Jun, length_samples_Jul, </span>
<span id="cb81-113"><a href="#cb81-113" aria-hidden="true" tabindex="-1"></a>                   length_samples_Aug)</span>
<span id="cb81-114"><a href="#cb81-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-115"><a href="#cb81-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-116"><a href="#cb81-116" aria-hidden="true" tabindex="-1"></a>length_samples_df<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb81-117"><a href="#cb81-117" aria-hidden="true" tabindex="-1"></a>  length_samples_df<span class="sc">$</span>month,</span>
<span id="cb81-118"><a href="#cb81-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"December"</span>, <span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>)</span>
<span id="cb81-119"><a href="#cb81-119" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-120"><a href="#cb81-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-121"><a href="#cb81-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine weight samples into a data frame</span></span>
<span id="cb81-122"><a href="#cb81-122" aria-hidden="true" tabindex="-1"></a>weight_samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-123"><a href="#cb81-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">month =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"December"</span>, <span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>), <span class="at">each =</span> <span class="dv">2000</span>),</span>
<span id="cb81-124"><a href="#cb81-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_value =</span> <span class="fu">c</span>(weight_samples_Dec, weight_samples_Jan, weight_samples_Feb, weight_samples_Mar, </span>
<span id="cb81-125"><a href="#cb81-125" aria-hidden="true" tabindex="-1"></a>                   weight_samples_Apr, weight_samples_May, weight_samples_Jun, weight_samples_Jul, </span>
<span id="cb81-126"><a href="#cb81-126" aria-hidden="true" tabindex="-1"></a>                   weight_samples_Aug)</span>
<span id="cb81-127"><a href="#cb81-127" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-128"><a href="#cb81-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-129"><a href="#cb81-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-130"><a href="#cb81-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-131"><a href="#cb81-131" aria-hidden="true" tabindex="-1"></a>weight_samples_df<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb81-132"><a href="#cb81-132" aria-hidden="true" tabindex="-1"></a>  weight_samples_df<span class="sc">$</span>month,</span>
<span id="cb81-133"><a href="#cb81-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"December"</span>, <span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>)</span>
<span id="cb81-134"><a href="#cb81-134" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-135"><a href="#cb81-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-136"><a href="#cb81-136" aria-hidden="true" tabindex="-1"></a>mean_length_values <span class="ot">&lt;-</span> length_samples_df <span class="sc">%&gt;%</span></span>
<span id="cb81-137"><a href="#cb81-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb81-138"><a href="#cb81-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_length =</span> <span class="fu">mean</span>(length_value))</span>
<span id="cb81-139"><a href="#cb81-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-140"><a href="#cb81-140" aria-hidden="true" tabindex="-1"></a>mean_weight_values <span class="ot">&lt;-</span> weight_samples_df <span class="sc">%&gt;%</span></span>
<span id="cb81-141"><a href="#cb81-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb81-142"><a href="#cb81-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight_value))</span>
<span id="cb81-143"><a href="#cb81-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-144"><a href="#cb81-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Update length histograms to include mean lines</span></span>
<span id="cb81-145"><a href="#cb81-145" aria-hidden="true" tabindex="-1"></a>length_histogram_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(length_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> length_value)) <span class="sc">+</span></span>
<span id="cb81-146"><a href="#cb81-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">7</span>, <span class="at">fill =</span> <span class="st">"slategray2"</span>, <span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb81-147"><a href="#cb81-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb81-148"><a href="#cb81-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mean_length_values, </span>
<span id="cb81-149"><a href="#cb81-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xintercept =</span> mean_length), </span>
<span id="cb81-150"><a href="#cb81-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"salmon4"</span>, <span class="co"># Change to a similar color as your weight graph</span></span>
<span id="cb81-151"><a href="#cb81-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb81-152"><a href="#cb81-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.8</span> <span class="co"># Adjust the line size to match your weight graph</span></span>
<span id="cb81-153"><a href="#cb81-153" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb81-154"><a href="#cb81-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb81-155"><a href="#cb81-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Length (mm)"</span>, </span>
<span id="cb81-156"><a href="#cb81-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb81-157"><a href="#cb81-157" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb81-158"><a href="#cb81-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> month, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># Use facet_wrap to arrange the plots by month</span></span>
<span id="cb81-159"><a href="#cb81-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb81-160"><a href="#cb81-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb81-161"><a href="#cb81-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb81-162"><a href="#cb81-162" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-163"><a href="#cb81-163" aria-hidden="true" tabindex="-1"></a>length_histogram_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/weight%20calculations-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update weight histograms to include mean lines</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>weight_histogram_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(weight_samples_df, <span class="fu">aes</span>(<span class="at">x =</span> weight_value)) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="fl">0.01</span>, </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"darkseagreen3"</span>, </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.2</span>, <span class="co"># Adjust the border size of the histogram bars</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span> <span class="co"># Adjust the transparency if needed</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mean_weight_values, </span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xintercept =</span> mean_weight), </span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"salmon4"</span>, </span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.8</span> <span class="co"># Adjust the line size to match your length graph</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Weight (kg)"</span>, </span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> month, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># Use facet_wrap to arrange the plots by month</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>weight_histogram_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/weight%20calculations-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save plots</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/length_histograms.pdf"</span>, <span class="at">plot =</span> length_histogram_plot, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/weight_histograms.pdf"</span>, <span class="at">plot =</span> weight_histogram_plot, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="age-0-count-function" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="age-0-count-function"><span class="header-section-number">6.1.2</span> Age-0 Count Function</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>calculate_total_salmon_consumed_multi_month_optimized <span class="ot">&lt;-</span> <span class="cf">function</span>(season, samples_list, abund_func, cf_func, demo_func, prop, days_list, ind_cons_funcs, chinook_weight_funcs) {</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  total_results <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="co"># List to store quantile results with change_name</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  raw_samples <span class="ot">&lt;-</span> <span class="fu">list</span>()    <span class="co"># List to store raw samples with change_name</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pre-generate the values that don't depend on the loop</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  abund_values <span class="ot">&lt;-</span> <span class="fu">abund_func</span>()</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  cf_values <span class="ot">&lt;-</span> <span class="fu">cf_func</span>()</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  demo_values <span class="ot">&lt;-</span> <span class="fu">demo_func</span>()</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  prop_values <span class="ot">&lt;-</span> prop</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pre-generate consumption values and Chinook weights for each month</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  consumption_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ind_cons_funcs, <span class="cf">function</span>(func) <span class="fu">func</span>())</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  chinook_weights <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chinook_weight_funcs, <span class="cf">function</span>(func) <span class="fu">func</span>())</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each change in the adjusted samples</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (change_name <span class="cf">in</span> <span class="fu">names</span>(samples_list)) {</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">startsWith</span>(change_name, season)) {</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract the adjusted samples</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>      current_samples <span class="ot">&lt;-</span> samples_list[[change_name]]</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate total salmon consumed over multiple months in one vectorized step</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>      total_consumed <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(days_list), <span class="cf">function</span>(i) {</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>          (abund_values <span class="sc">*</span> cf_values <span class="sc">*</span> demo_values <span class="sc">*</span> prop_values <span class="sc">*</span> days_list[i] <span class="sc">*</span> (consumption_values[i] <span class="sc">/</span> chinook_weights[i])) <span class="sc">*</span> current_samples</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the quantile results with the change_name included</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>      quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>      total_results[[change_name]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">change_name =</span> change_name, </span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">median =</span> quantiles[<span class="dv">1</span>], </span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">lower_95 =</span> quantiles[<span class="dv">2</span>], </span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">upper_95 =</span> quantiles[<span class="dv">3</span>], </span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">lower_25 =</span> quantiles[<span class="dv">4</span>], </span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">upper_75 =</span> quantiles[<span class="dv">5</span>])</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the raw total consumed samples with the change_name included</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>      raw_samples[[change_name]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">change_name =</span> change_name, <span class="at">total_consumed =</span> total_consumed)</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the results to dataframes</span></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>  quantiles_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, total_results)</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>  raw_samples_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, raw_samples)</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">quantiles =</span> quantiles_df, <span class="at">raw_samples =</span> raw_samples_df))</span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="winter-3" class="level4" data-number="6.1.2.1">
<h4 data-number="6.1.2.1" class="anchored" data-anchor-id="winter-3"><span class="header-section-number">6.1.2.1</span> Winter</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Winter calculations</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Winter calculations for Juvenile Females</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>count_WinterJuvF <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"winter"</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> WinAbund,</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> WinJuvDemo,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> PropJuvF,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># December, January, February days</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionJuvF, IndDailyConsumptionJuvF, IndDailyConsumptionJuvF),</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(DecJuvChinWt, JanJuvChinWt, FebJuvChinWt)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Winter calculations for Juvenile Males</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>count_WinterJuvM <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"winter"</span>,</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> WinAbund,</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> WinJuvDemo,</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> PropJuvM,</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># December, January, February days</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionJuvM, IndDailyConsumptionJuvM, IndDailyConsumptionJuvM),</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(DecJuvChinWt, JanJuvChinWt, FebJuvChinWt)</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Winter calculations for Adult Females</span></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>count_WinterAdF <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"winter"</span>,</span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> WinAbund,</span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> WinFemDemo,</span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">1</span>,  <span class="co"># Assuming full representation for adults</span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># December, January, February days</span></span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionAdF, IndDailyConsumptionAdF, IndDailyConsumptionAdF),</span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(DecJuvChinWt, JanJuvChinWt, FebJuvChinWt)</span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Winter calculations for Adult Males</span></span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>count_WinterAdM <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"winter"</span>,</span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> WinAbund,</span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> WinMaleDemo,</span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">1</span>,  <span class="co"># Assuming full representation for adults</span></span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># December, January, February days</span></span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionAdF, IndDailyConsumptionAdF, IndDailyConsumptionAdF),</span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(DecJuvChinWt, JanJuvChinWt, FebJuvChinWt)</span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a>count_WinterAdF_df <span class="ot">&lt;-</span> count_WinterAdF<span class="sc">$</span>raw_samples</span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a>count_WinterAdM_df <span class="ot">&lt;-</span> count_WinterAdM<span class="sc">$</span>raw_samples</span>
<span id="cb85-56"><a href="#cb85-56" aria-hidden="true" tabindex="-1"></a>count_WinterJuvM_df <span class="ot">&lt;-</span> count_WinterJuvM<span class="sc">$</span>raw_samples</span>
<span id="cb85-57"><a href="#cb85-57" aria-hidden="true" tabindex="-1"></a>count_WinterJuvF_df <span class="ot">&lt;-</span> count_WinterJuvF<span class="sc">$</span>raw_samples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>sum_consumed_by_change_group <span class="ot">&lt;-</span> <span class="cf">function</span>(demographic_df_list) {</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure all dataframes are aligned by change_name</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(demographic_df_list)) {</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    demographic_df_list[[i]] <span class="ot">&lt;-</span> demographic_df_list[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(change_name)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize an empty dataframe to store results</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  result_df <span class="ot">&lt;-</span> demographic_df_list[[<span class="dv">1</span>]]  <span class="co"># Start with the first dataframe's structure</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summing total_consumed across demographic groups for each change_name</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  result_df<span class="sc">$</span>total_consumed <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Initialize the total_consumed column</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each unique change_name and sum corresponding rows from each demographic dataframe</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  unique_change_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(result_df<span class="sc">$</span>change_name)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (change <span class="cf">in</span> unique_change_names) {</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Subset each dataframe for the current change_name</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    filtered_dfs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(demographic_df_list, <span class="cf">function</span>(df) df[df<span class="sc">$</span>change_name <span class="sc">==</span> change, <span class="st">"total_consumed"</span>])</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sum the total_consumed values across demographic groups for this change_name</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>    result_df[result_df<span class="sc">$</span>change_name <span class="sc">==</span> change, <span class="st">"total_consumed"</span>] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">do.call</span>(cbind, filtered_dfs), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result_df)</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage: summing across the winter demographic groups within each change_name</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>winter_demographic_count <span class="ot">&lt;-</span> <span class="fu">list</span>(count_WinterAdF_df, count_WinterAdM_df, count_WinterJuvM_df, count_WinterJuvF_df)</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the summed results across demographic groups by change_name</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>merged_winter_samples <span class="ot">&lt;-</span> <span class="fu">sum_consumed_by_change_group</span>(winter_demographic_count)</span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>merged_winter_samples<span class="sc">$</span>change_name <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^winter_"</span>, <span class="st">""</span>, merged_winter_samples<span class="sc">$</span>change_name)</span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>quantile_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.975</span>)</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate quantiles for each change group, including 25th and 75th percentiles</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>merged_winter_samples_sum <span class="ot">&lt;-</span> merged_winter_samples <span class="sc">%&gt;%</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(change_name) <span class="sc">%&gt;%</span></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_min =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_max =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(merged_winter_samples) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spring calculations for Juvenile Females</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>count_SpringJuvF <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"spring"</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SprAbund,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SprJuvDemo,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> PropJuvF,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># March, April, May days</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionJuvF, IndDailyConsumptionJuvF, IndDailyConsumptionJuvF),</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(MarJuvChinWt, AprJuvChinWt, MayJuvChinWt)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Spring calculations for Juvenile Males</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>count_SpringJuvM <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"spring"</span>,</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SprAbund,</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SprJuvDemo,</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> PropJuvM,</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># March, April, May days</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionJuvM, IndDailyConsumptionJuvM, IndDailyConsumptionJuvM),</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(MarJuvChinWt, AprJuvChinWt, MayJuvChinWt)</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Spring calculations for Adult Females</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>count_SpringAdF <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"spring"</span>,</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SprAbund,</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SprFemDemo,</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">1</span>,  <span class="co"># Assuming full representation for adults</span></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># March, April, May days</span></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionAdF, IndDailyConsumptionAdF, IndDailyConsumptionAdF),</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(MarJuvChinWt, AprJuvChinWt, MayJuvChinWt)</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Spring calculations for Adult Males</span></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>count_SpringAdM <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"spring"</span>,</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SprAbund,</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> WinSprFallCF,</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SprMaleDemo,</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">1</span>,  <span class="co"># Assuming full representation for adults</span></span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># March, April, May days</span></span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionAdF, IndDailyConsumptionAdF, IndDailyConsumptionAdF),</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(MarJuvChinWt, AprJuvChinWt, MayJuvChinWt)</span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>count_SpringAdF_df <span class="ot">&lt;-</span> count_SpringAdF<span class="sc">$</span>raw_samples</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>count_SpringAdM_df <span class="ot">&lt;-</span> count_SpringAdM<span class="sc">$</span>raw_samples</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>count_SpringJuvM_df <span class="ot">&lt;-</span> count_SpringJuvM<span class="sc">$</span>raw_samples</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>count_SpringJuvF_df <span class="ot">&lt;-</span> count_SpringJuvF<span class="sc">$</span>raw_samples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the spring dataframes are similar to the winter ones</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>spring_demographic_count <span class="ot">&lt;-</span> <span class="fu">list</span>(count_SpringAdF_df, count_SpringAdM_df, count_SpringJuvM_df, count_SpringJuvF_df)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the summed results across demographic groups by change_name for Spring</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>merged_spring_samples <span class="ot">&lt;-</span> <span class="fu">sum_consumed_by_change_group</span>(spring_demographic_count)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the "spring_" prefix from change_name in the Spring dataframe</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>merged_spring_samples<span class="sc">$</span>change_name <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^spring_"</span>, <span class="st">""</span>, merged_spring_samples<span class="sc">$</span>change_name)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove row names from Spring dataframe</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(merged_spring_samples) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>merged_spring_samples_sum <span class="ot">&lt;-</span> merged_spring_samples <span class="sc">%&gt;%</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(change_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_min =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_max =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summer calculations for Juvenile Females</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>count_SummerJuvF <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"summer"</span>,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SumAbund,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> SummerCF,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SumJuvDemo,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> PropJuvF,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># June, July, August days</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionJuvF, IndDailyConsumptionJuvF, IndDailyConsumptionJuvF),</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(JunJuvChinWt, JulJuvChinWt, AugJuvChinWt)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Summer calculations for Juvenile Males</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>count_SummerJuvM <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"summer"</span>,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SumAbund,</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> SummerCF,</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SumJuvDemo,</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> PropJuvM,</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># June, July, August days</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionJuvM, IndDailyConsumptionJuvM, IndDailyConsumptionJuvM),</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(JunJuvChinWt, JulJuvChinWt, AugJuvChinWt)</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Summer calculations for Adult Females</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>count_SummerAdF <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"summer"</span>,</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SumAbund,</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> SummerCF,</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SumFemDemo,</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">1</span>,  <span class="co"># Assuming full representation for adults</span></span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># June, July, August days</span></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionAdF, IndDailyConsumptionAdF, IndDailyConsumptionAdF),</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(JunJuvChinWt, JulJuvChinWt, AugJuvChinWt)</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Summer calculations for Adult Males</span></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>count_SummerAdM <span class="ot">&lt;-</span> <span class="fu">calculate_total_salmon_consumed_multi_month_optimized</span>(</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> <span class="st">"summer"</span>,</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples_list =</span> adjusted_samples_list,</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">abund_func =</span> SumAbund,</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">cf_func =</span> SummerCF,</span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">demo_func =</span> SumMaleDemo,</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">1</span>,  <span class="co"># Assuming full representation for adults</span></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_list =</span> <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">28</span>),  <span class="co"># June, July, August days</span></span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">ind_cons_funcs =</span> <span class="fu">list</span>(IndDailyConsumptionAdF, IndDailyConsumptionAdF, IndDailyConsumptionAdF),</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">chinook_weight_funcs =</span> <span class="fu">list</span>(JunJuvChinWt, JulJuvChinWt, AugJuvChinWt)</span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a>count_SummerAdF_df <span class="ot">&lt;-</span> count_SummerAdF<span class="sc">$</span>raw_samples</span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a>count_SummerAdM_df <span class="ot">&lt;-</span> count_SummerAdM<span class="sc">$</span>raw_samples</span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a>count_SummerJuvM_df <span class="ot">&lt;-</span> count_SummerJuvM<span class="sc">$</span>raw_samples</span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>count_SummerJuvF_df <span class="ot">&lt;-</span> count_SummerJuvF<span class="sc">$</span>raw_samples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>summer_demographic_count <span class="ot">&lt;-</span> <span class="fu">list</span>(count_SummerAdF_df, count_SummerAdM_df, count_SummerJuvM_df, count_SummerJuvF_df)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the summed results across demographic groups by change_name for Summer</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>merged_summer_samples <span class="ot">&lt;-</span> <span class="fu">sum_consumed_by_change_group</span>(summer_demographic_count)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>merged_summer_samples <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(merged_summer_samples)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the "summer_" prefix from change_name in the Summer dataframe</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>merged_summer_samples<span class="sc">$</span>change_name <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^summer_"</span>, <span class="st">""</span>, merged_summer_samples<span class="sc">$</span>change_name)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>merged_summer_samples_sum <span class="ot">&lt;-</span> merged_summer_samples <span class="sc">%&gt;%</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(change_name) <span class="sc">%&gt;%</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_min =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.025</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_low =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_high =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_max =</span> <span class="fu">quantile</span>(total_consumed, <span class="at">probs =</span> <span class="fl">0.975</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove row names from Summer dataframe</span></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(merged_summer_samples) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print unique change_name values for Summer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="seasonal-sensitivity-plot-count-of-age-0-chinook-salmon" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="seasonal-sensitivity-plot-count-of-age-0-chinook-salmon"><span class="header-section-number">6.1.3</span> Seasonal sensitivity plot count of Age-0 Chinook Salmon</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>merged_winter_samples_sum<span class="sc">$</span>Season <span class="ot">&lt;-</span> <span class="st">"Winter"</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>merged_spring_samples_sum<span class="sc">$</span>Season <span class="ot">&lt;-</span> <span class="st">"Spring"</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>merged_summer_samples_sum<span class="sc">$</span>Season <span class="ot">&lt;-</span> <span class="st">"Summer"</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>age0_count_byseason <span class="ot">&lt;-</span> <span class="fu">rbind</span>(merged_winter_samples_sum, merged_spring_samples_sum, merged_summer_samples_sum) </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>age0_count_df <span class="ot">&lt;-</span> age0_count_byseason <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Change_Simplified =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"10%_Up"</span>, change_name) <span class="sc">~</span> <span class="st">"10% Increase"</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"10%_Down"</span>, change_name) <span class="sc">~</span> <span class="st">"10% Decrease"</span>,</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"25%_Up"</span>, change_name) <span class="sc">~</span> <span class="st">"25% Increase"</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"25%_Down"</span>, change_name) <span class="sc">~</span> <span class="st">"25% Decrease"</span>,</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"50%_Up"</span>, change_name) <span class="sc">~</span> <span class="st">"50% Increase"</span>,</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"50%_Down"</span>, change_name) <span class="sc">~</span> <span class="st">"50% Decrease"</span>,</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Original_Proportion"</span>, change_name) <span class="sc">~</span> <span class="st">"Original Proportion"</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>age0_count_byseason_changes <span class="ot">&lt;-</span> age0_count_df <span class="sc">%&gt;%</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Original Proportion"</span>, Change_Simplified))</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>age0_count_byseason_original <span class="ot">&lt;-</span> age0_count_df <span class="sc">%&gt;%</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Original Proportion"</span>, Change_Simplified))</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>change_plot_age0count <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age0_count_byseason_changes, <span class="fu">aes</span>(<span class="at">x =</span> Season, <span class="at">y =</span> avg)) <span class="sc">+</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add smaller confidence interval (ci_low and ci_high) - draw this second to bring it to the front, set width to 0 to remove T's</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_high), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Count of Age-0 Chinook sensitivity test"</span>,</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Season"</span>,</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Count of Age-0 Chinook"</span>) <span class="sc">+</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Change_Simplified, <span class="at">scales =</span> <span class="st">"fixed"</span>, <span class="at">ncol =</span> <span class="dv">2</span>)  <span class="co"># Set scales to "fixed" for a uniform y-axis</span></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>change_plot_age0count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/plot%20of%20age0%20count%20by%20sensitivity%20changes-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot only the original proportions</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>original_plot_age0count <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age0_count_byseason_original, <span class="fu">aes</span>(<span class="at">x =</span> Season, <span class="at">y =</span> avg)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"gray"</span>,<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add larger confidence interval (ci_min and ci_max)</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add smaller confidence interval (ci_low and ci_high)</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_low, <span class="at">ymax =</span> ci_high), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"sienna3"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Season"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Count of Age-0 Chinook"</span>) <span class="sc">+</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>original_plot_age0count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/plot%20of%20age0%20count%20by%20sensitivity%20changes-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(age0_count_byseason_original)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">change_name</th>
<th style="text-align: right;">ci_min</th>
<th style="text-align: right;">ci_low</th>
<th style="text-align: right;">avg</th>
<th style="text-align: right;">ci_high</th>
<th style="text-align: right;">ci_max</th>
<th style="text-align: left;">Season</th>
<th style="text-align: left;">Change_Simplified</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: right;">476945.6</td>
<td style="text-align: right;">666260.4</td>
<td style="text-align: right;">791126.8</td>
<td style="text-align: right;">933280.2</td>
<td style="text-align: right;">1279366</td>
<td style="text-align: left;">Winter</td>
<td style="text-align: left;">Original Proportion</td>
</tr>
<tr class="even">
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: right;">424954.9</td>
<td style="text-align: right;">648337.0</td>
<td style="text-align: right;">786408.4</td>
<td style="text-align: right;">955893.8</td>
<td style="text-align: right;">1338671</td>
<td style="text-align: left;">Spring</td>
<td style="text-align: left;">Original Proportion</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: right;">121908.7</td>
<td style="text-align: right;">282234.9</td>
<td style="text-align: right;">424573.1</td>
<td style="text-align: right;">591096.8</td>
<td style="text-align: right;">1095225</td>
<td style="text-align: left;">Summer</td>
<td style="text-align: left;">Original Proportion</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure 7.pdf"</span>, original_plot_age0count, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="overall-calculations" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="overall-calculations"><span class="header-section-number">6.2</span> Overall calculations</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> merged_winter_samples <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="st">"Winter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    merged_spring_samples <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">season =</span> <span class="st">"Spring"</span>),</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    merged_summer_samples <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">season =</span> <span class="st">"Summer"</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get unique change names</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>unique_change_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(combined_df<span class="sc">$</span>change_name)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize empty lists to store wide dataframes and summary statistics</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>wide_dfs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>summarized_stats_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each unique change_name and perform operations</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (change <span class="cf">in</span> unique_change_names) {</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter combined_df and pivot to wide format</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  change_wide <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(change_name <span class="sc">==</span> change) <span class="sc">%&gt;%</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> season, <span class="at">values_from =</span> total_consumed, <span class="at">values_fn =</span> list) <span class="sc">%&gt;%</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(Winter, Spring, Summer))</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate total consumed for the year</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  change_wide<span class="sc">$</span>total_consumed_yearly <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(change_wide[, <span class="fu">c</span>(<span class="st">"Winter"</span>, <span class="st">"Spring"</span>, <span class="st">"Summer"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the wide dataframe</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  wide_dfs[[change]] <span class="ot">&lt;-</span> change_wide</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate summary statistics</span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>  summarized_stats_list[[change]] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>    change_wide<span class="sc">$</span>total_consumed_yearly, </span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>), </span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of change groups to bind together</span></span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>change_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Change_10%_Up"</span>, <span class="st">"Change_10%_Down"</span>, <span class="st">"Change_25%_Up"</span>, <span class="st">"Change_25%_Down"</span>, </span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Change_50%_Up"</span>, <span class="st">"Change_50%_Down"</span>, <span class="st">"Original_Proportion"</span>)</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind wide dataframes for each change group with an additional change_name column</span></span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>combined_wide_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(change_groups, <span class="cf">function</span>(change) {</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>  wide_dfs[[change]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">change_name =</span> change)</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind summary statistics for each change group</span></span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>overall_count_age0_summary <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(change_groups, <span class="cf">function</span>(change) {</span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">change_name =</span> change, <span class="fu">t</span>(summarized_stats_list[[change]]))</span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="bootstrapping-1" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="bootstrapping-1"><span class="header-section-number">6.2.1</span> bootstrapping</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>age0_count_output <span class="ot">&lt;-</span> combined_wide_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(change_name, total_consumed_yearly)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform bootstrapping</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>run_bootstrap_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(original_dist, change_dist, <span class="at">n_sims =</span> <span class="dv">2000</span>) {</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate observed difference</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>   dist_1<span class="ot">&lt;-</span> <span class="fu">log</span>(change_dist)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>   dist_2<span class="ot">&lt;-</span> <span class="fu">log</span>(original_dist)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  observed_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(dist_1) <span class="sc">-</span> <span class="fu">mean</span>(dist_2)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine both distributions</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(dist_1, dist_2)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize a vector to store the resampled differences</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sims)</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bootstrap resampling</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sims) {</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined, <span class="fu">length</span>(combined), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>    dist_1_resample <span class="ot">&lt;-</span> shuffled[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dist_1)]</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>    dist_2_resample <span class="ot">&lt;-</span> shuffled[(<span class="fu">length</span>(dist_1) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="fu">length</span>(combined))]</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>    diffs[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(dist_1_resample) <span class="sc">-</span> <span class="fu">mean</span>(dist_2_resample)</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the p-value</span></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(diffs) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_diff))</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return observed difference and p-value</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">observed_diff =</span> observed_diff, <span class="at">p_value =</span> p_value))</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the original distribution for "Original_Proportion" from age0_count_output</span></span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>original_dist <span class="ot">&lt;-</span> age0_count_output <span class="sc">%&gt;%</span></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(change_name <span class="sc">==</span> <span class="st">"Original_Proportion"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(total_consumed_yearly)</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a><span class="co"># List of changes to compare against the original</span></span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>changes_to_compare <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Change_10%_Up"</span>, <span class="st">"Change_10%_Down"</span>, <span class="st">"Change_25%_Up"</span>, </span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Change_25%_Down"</span>, <span class="st">"Change_50%_Up"</span>, <span class="st">"Change_50%_Down"</span>)</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame to store results</span></span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>age0_count_bootresults <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Change_Comparison =</span> <span class="fu">character</span>(), <span class="at">Observed_Difference =</span> <span class="fu">numeric</span>(), <span class="at">P_Value =</span> <span class="fu">numeric</span>(), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each change and run the bootstrap analysis</span></span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (change <span class="cf">in</span> changes_to_compare) {</span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a>  comparison_dist <span class="ot">&lt;-</span> age0_count_output <span class="sc">%&gt;%</span></span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(change_name <span class="sc">==</span> change) <span class="sc">%&gt;%</span></span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(total_consumed_yearly)</span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the comparison distribution is not empty</span></span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(comparison_dist) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No data for"</span>, change, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run the bootstrap analysis</span></span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">run_bootstrap_analysis</span>(original_dist, comparison_dist)</span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the result to the results dataframe</span></span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>    age0_count_bootresults <span class="ot">&lt;-</span> <span class="fu">rbind</span>(age0_count_bootresults, <span class="fu">data.frame</span>(<span class="at">Change_Comparison =</span> change,</span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Observed_Difference =</span> result[<span class="st">'observed_diff'</span>],</span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">P_Value =</span> result[<span class="st">'p_value'</span>]))</span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a>overall_count_age0_summary_table <span class="ot">&lt;-</span> overall_count_age0_summary <span class="sc">%&gt;%</span></span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"X50."</span>, <span class="st">"ci_min"</span> <span class="ot">=</span> <span class="st">"X2.5."</span>, <span class="st">"ci_max"</span> <span class="ot">=</span> <span class="st">"X97.5."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb96-70"><a href="#cb96-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">paste0</span>(</span>
<span id="cb96-71"><a href="#cb96-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formatC</span>(Median, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">digits =</span> <span class="dv">0</span>), </span>
<span id="cb96-72"><a href="#cb96-72" aria-hidden="true" tabindex="-1"></a>      <span class="st">" ("</span>, </span>
<span id="cb96-73"><a href="#cb96-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formatC</span>(ci_min, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">digits =</span> <span class="dv">0</span>), </span>
<span id="cb96-74"><a href="#cb96-74" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-"</span>, </span>
<span id="cb96-75"><a href="#cb96-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formatC</span>(ci_max, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">digits =</span> <span class="dv">0</span>), </span>
<span id="cb96-76"><a href="#cb96-76" aria-hidden="true" tabindex="-1"></a>      <span class="st">")"</span></span>
<span id="cb96-77"><a href="#cb96-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb96-78"><a href="#cb96-78" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb96-79"><a href="#cb96-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"Change_Comparison"</span> <span class="ot">=</span> <span class="st">"change_name"</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Change_Comparison,Median)</span>
<span id="cb96-80"><a href="#cb96-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-81"><a href="#cb96-81" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(overall_count_age0_summary_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Change_Comparison</th>
<th style="text-align: left;">Median</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: left;">2,247,983 (1,535,813-3,165,494)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: left;">1,875,745 (1,266,216-2,675,260)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: left;">2,523,218 (1,780,010-3,566,843)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: left;">1,577,026 (1,029,159-2,337,896)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: left;">3,010,663 (2,168,187-4,079,243)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: left;">1,105,141 (643,241-1,802,240)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: left;">2,064,418 (1,431,524-2,932,922)</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>age0_count_bootresults<span class="sc">$</span>inverse_log_values <span class="ot">&lt;-</span> <span class="fu">exp</span>(age0_count_bootresults<span class="sc">$</span>Observed_Difference)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>age0_count_bootresults<span class="sc">$</span>percent_change <span class="ot">&lt;-</span> (age0_count_bootresults<span class="sc">$</span>inverse_log_values<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>age0_count_bootresults<span class="sc">$</span>base_age0avg <span class="ot">&lt;-</span> overall_count_age0_summary <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(change_name <span class="sc">==</span> <span class="st">"Original_Proportion"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">'X50.'</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>age0_count_bootresults<span class="sc">$</span>expected_value <span class="ot">&lt;-</span> age0_count_bootresults<span class="sc">$</span>base_age0avg <span class="sc">*</span> age0_count_bootresults<span class="sc">$</span>inverse_log_values</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>age0_count_bootresults_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(overall_count_age0_summary_table, age0_count_bootresults, <span class="at">by =</span> <span class="st">"Change_Comparison"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(age0_count_bootresults_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Change_Comparison</th>
<th style="text-align: left;">Median</th>
<th style="text-align: right;">Observed_Difference</th>
<th style="text-align: right;">P_Value</th>
<th style="text-align: right;">inverse_log_values</th>
<th style="text-align: right;">percent_change</th>
<th style="text-align: right;">base_age0avg</th>
<th style="text-align: right;">expected_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Change_10%_Down</td>
<td style="text-align: left;">1,875,745 (1,266,216-2,675,260)</td>
<td style="text-align: right;">-0.0991597</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9055980</td>
<td style="text-align: right;">-9.440195</td>
<td style="text-align: right;">2064418</td>
<td style="text-align: right;">1869533</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_10%_Up</td>
<td style="text-align: left;">2,247,983 (1,535,813-3,165,494)</td>
<td style="text-align: right;">0.0863286</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.0901645</td>
<td style="text-align: right;">9.016449</td>
<td style="text-align: right;">2064418</td>
<td style="text-align: right;">2250555</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_25%_Down</td>
<td style="text-align: left;">1,577,026 (1,029,159-2,337,896)</td>
<td style="text-align: right;">-0.2745187</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.7599378</td>
<td style="text-align: right;">-24.006221</td>
<td style="text-align: right;">2064418</td>
<td style="text-align: right;">1568829</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_25%_Up</td>
<td style="text-align: left;">2,523,218 (1,780,010-3,566,843)</td>
<td style="text-align: right;">0.2027521</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.2247688</td>
<td style="text-align: right;">22.476883</td>
<td style="text-align: right;">2064418</td>
<td style="text-align: right;">2528434</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Change_50%_Down</td>
<td style="text-align: left;">1,105,141 (643,241-1,802,240)</td>
<td style="text-align: right;">-0.6269204</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5342345</td>
<td style="text-align: right;">-46.576551</td>
<td style="text-align: right;">2064418</td>
<td style="text-align: right;">1102883</td>
</tr>
<tr class="even">
<td style="text-align: left;">Change_50%_Up</td>
<td style="text-align: left;">3,010,663 (2,168,187-4,079,243)</td>
<td style="text-align: right;">0.3761548</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.4566726</td>
<td style="text-align: right;">45.667259</td>
<td style="text-align: right;">2064418</td>
<td style="text-align: right;">3007180</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Original_Proportion</td>
<td style="text-align: left;">2,064,418 (1,431,524-2,932,922)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for better clarity</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(overall_count_age0_summary) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Change"</span>, <span class="st">"50%"</span>, <span class="st">"2.5%"</span>, <span class="st">"97.5%"</span>, <span class="st">"25%"</span>, <span class="st">"75%"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the median (50%) column for plotting</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> overall_count_age0_summary <span class="sc">%&gt;%</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Change, <span class="st">`</span><span class="at">50%</span><span class="st">`</span>, <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>, <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>, <span class="st">`</span><span class="at">25%</span><span class="st">`</span>, <span class="st">`</span><span class="at">75%</span><span class="st">`</span>) </span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>Change <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>Change,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Original_Proportion"</span>, <span class="st">"Change_10%_Down"</span>, <span class="st">"Change_10%_Up"</span>, <span class="st">"Change_25%_Down"</span>, <span class="st">"Change_25%_Up"</span>,<span class="st">"Change_50%_Down"</span>, <span class="st">"Change_50%_Up"</span>),  <span class="co"># Specify the original order</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Base Model"</span>, <span class="st">"10% Decrease"</span>, <span class="st">"10% Increase"</span>, <span class="st">"25% Decrease"</span>, <span class="st">"25% Increase"</span>,<span class="st">"50% Decrease"</span>, <span class="st">"50% Increase"</span>)  <span class="co"># Specify the new labels</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot with error bars for confidence intervals</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>count_plot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Change, <span class="at">y =</span> <span class="st">`</span><span class="at">50%</span><span class="st">`</span>, <span class="at">fill =</span> Change)) <span class="sc">+</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>, <span class="at">ymax =</span> <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="st">`</span><span class="at">25%</span><span class="st">`</span>, <span class="at">ymax =</span> <span class="st">`</span><span class="at">75%</span><span class="st">`</span>), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"sienna3"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count of Age-0 Chinook consumed"</span>, </span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Change Type"</span>) <span class="sc">+</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>count_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/count%20age-0%20overall%20plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure9.pdf"</span>, <span class="at">plot =</span> count_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="daily-consumption-of-chinook-salmon-per-individual-steller-sea-lion" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Daily consumption of Chinook salmon per individual Steller sea lion</h1>
<p>Alongside looking at the overall consumption by Steller sea lions along the coast of Washington, we also calculated daily rates of the number of age-0 Chinook salmon consumed by an individual Steller sea lion depending on age, sex, and month.</p>
<section id="daily-biomass-of-age-0-chinook-salmon-consumed-per-ssl-demographic" class="level2 tabset" data-number="7.1">
<h2 class="tabset anchored" data-number="7.1" data-anchor-id="daily-biomass-of-age-0-chinook-salmon-consumed-per-ssl-demographic"><span class="header-section-number">7.1</span> Daily biomass of age-0 Chinook salmon consumed per SSL demographic</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to calculate biomass or salmon count</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>calculate_consumption <span class="ot">&lt;-</span> <span class="cf">function</span>(demo_function, chin_weight, age_og, <span class="at">n =</span> <span class="dv">2000</span>) {</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure chin_weight and age_og are scalars and applied element-wise across replicates</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  replicates <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n, <span class="fu">demo_function</span>())  <span class="co"># Generate 10,000 replicates</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  replicates_adjusted <span class="ot">&lt;-</span> replicates <span class="sc">/</span> chin_weight <span class="sc">*</span> age_og  <span class="co"># Apply scalar adjustments</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(replicates_adjusted, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>))  <span class="co"># Return quantiles</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through demographics and months</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>demographics <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">JuvF =</span> IndDailyConsumptionJuvF, </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">JuvM =</span> IndDailyConsumptionJuvM, </span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">AdF =</span> IndDailyConsumptionAdF, </span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">AdM =</span> IndDailyConsumptionAdM)</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dec"</span>, <span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>)</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">DecJuvChinWt</span>(), <span class="fu">JanJuvChinWt</span>(), <span class="fu">FebJuvChinWt</span>(), <span class="fu">MarJuvChinWt</span>(), <span class="fu">AprJuvChinWt</span>(),</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">MayJuvChinWt</span>(), <span class="fu">JunJuvChinWt</span>(), <span class="fu">JulJuvChinWt</span>(), <span class="fu">AugJuvChinWt</span>())</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>age_og <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">winter =</span> winter_age0_og, <span class="at">spring =</span> spring_age0_og, <span class="at">summer =</span> summer_age0_og)</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe to store results</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (demo_name <span class="cf">in</span> <span class="fu">names</span>(demographics)) {</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  demo_func <span class="ot">&lt;-</span> demographics[[demo_name]]</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(months)) {</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>    month <span class="ot">&lt;-</span> months[i]</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>    weight <span class="ot">&lt;-</span> weights[i]</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>    season <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(i <span class="sc">&lt;=</span> <span class="dv">3</span>, <span class="st">"winter"</span>, <span class="fu">ifelse</span>(i <span class="sc">&lt;=</span> <span class="dv">6</span>, <span class="st">"spring"</span>, <span class="st">"summer"</span>))</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Biomass calculation</span></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>    biomass <span class="ot">&lt;-</span> <span class="fu">calculate_consumption</span>(demo_func, <span class="dv">1</span>, age_og[[season]])</span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Salmon count calculation</span></span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>    salmon_count <span class="ot">&lt;-</span> <span class="fu">calculate_consumption</span>(demo_func, weight, age_og[[season]])</span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store the results in a dataframe for both biomass and salmon count</span></span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a>    quantile_df_biomass <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">demo_month =</span> <span class="fu">paste</span>(demo_name, month, <span class="at">sep =</span> <span class="st">"_"</span>),</span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"biomass"</span>, </span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">median =</span> biomass[<span class="dv">1</span>],</span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_lower =</span> biomass[<span class="dv">2</span>],</span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_upper =</span> biomass[<span class="dv">3</span>]</span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a>    quantile_df_salmon <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">demo_month =</span> <span class="fu">paste</span>(demo_name, month, <span class="at">sep =</span> <span class="st">"_"</span>),</span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"salmon_count"</span>, </span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">median =</span> salmon_count[<span class="dv">1</span>],</span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_lower =</span> salmon_count[<span class="dv">2</span>],</span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_upper =</span> salmon_count[<span class="dv">3</span>]</span>
<span id="cb100-52"><a href="#cb100-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb100-53"><a href="#cb100-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-54"><a href="#cb100-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Append both dataframes to the results_df</span></span>
<span id="cb100-55"><a href="#cb100-55" aria-hidden="true" tabindex="-1"></a>    results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(results_df, quantile_df_biomass))</span>
<span id="cb100-56"><a href="#cb100-56" aria-hidden="true" tabindex="-1"></a>    results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(results_df, quantile_df_salmon))</span>
<span id="cb100-57"><a href="#cb100-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb100-58"><a href="#cb100-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="summary-graph" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="summary-graph"><span class="header-section-number">7.1.1</span> Summary Graph</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(results_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>combined_salmon_count <span class="ot">&lt;-</span> results_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"salmon_count"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>type)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>combined_salmon_count <span class="ot">&lt;-</span> <span class="fu">separate</span>(combined_salmon_count, <span class="at">col =</span> demo_month, <span class="at">into =</span> <span class="fu">c</span>( <span class="st">'demo'</span>, <span class="st">'Month'</span>))</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Combine `median`, `ci_lower`, and `ci_upper` into one column</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>combined_salmon_count_format <span class="ot">&lt;-</span> combined_salmon_count <span class="sc">%&gt;%</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(median, <span class="dv">1</span>), <span class="st">" ("</span>, <span class="fu">round</span>(ci_lower, <span class="dv">1</span>), <span class="st">"-"</span>, <span class="fu">round</span>(ci_upper, <span class="dv">1</span>), <span class="st">")"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(demo, Month, value)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Pivot wider to have `demographic` as columns and `month` as rows</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>combined_salmon_count_wide <span class="ot">&lt;-</span> combined_salmon_count_format <span class="sc">%&gt;%</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> demo, <span class="at">values_from =</span> value)</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>combined_salmon_count_wide <span class="sc">%&gt;%</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">format</span>(., <span class="at">digits =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Month</th>
<th style="text-align: left;">JuvF</th>
<th style="text-align: left;">JuvM</th>
<th style="text-align: left;">AdF</th>
<th style="text-align: left;">AdM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dec</td>
<td style="text-align: left;">7.1 (3.7-13.3)</td>
<td style="text-align: left;">9.2 (4.6-17.7)</td>
<td style="text-align: left;">9.3 (5.4-16.6)</td>
<td style="text-align: left;">18 (8.9-33.7)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jan</td>
<td style="text-align: left;">1.2 (0.6-2.2)</td>
<td style="text-align: left;">1.5 (0.8-2.9)</td>
<td style="text-align: left;">1.5 (0.9-2.6)</td>
<td style="text-align: left;">2.9 (1.5-5.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Feb</td>
<td style="text-align: left;">2.7 (1.4-4.9)</td>
<td style="text-align: left;">3.3 (1.7-6.3)</td>
<td style="text-align: left;">3.4 (1.9-5.8)</td>
<td style="text-align: left;">6.5 (3.2-12.4)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mar</td>
<td style="text-align: left;">3.5 (1.7-6.8)</td>
<td style="text-align: left;">4.6 (2.1-9)</td>
<td style="text-align: left;">4.5 (2.3-8.3)</td>
<td style="text-align: left;">8.9 (3.9-17.5)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apr</td>
<td style="text-align: left;">4.5 (2.1-8.8)</td>
<td style="text-align: left;">5.9 (2.7-11.4)</td>
<td style="text-align: left;">5.9 (3-10.8)</td>
<td style="text-align: left;">11.5 (5.2-22.5)</td>
</tr>
<tr class="even">
<td style="text-align: left;">May</td>
<td style="text-align: left;">0.7 (0.3-1.4)</td>
<td style="text-align: left;">0.9 (0.4-1.8)</td>
<td style="text-align: left;">0.9 (0.5-1.7)</td>
<td style="text-align: left;">1.8 (0.8-3.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jun</td>
<td style="text-align: left;">2.2 (0.6-6.4)</td>
<td style="text-align: left;">2.9 (0.8-8.2)</td>
<td style="text-align: left;">2.9 (0.9-8)</td>
<td style="text-align: left;">5.6 (1.5-16.5)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jul</td>
<td style="text-align: left;">3.1 (0.9-9.1)</td>
<td style="text-align: left;">4 (1.1-12.4)</td>
<td style="text-align: left;">4.2 (1.2-11.3)</td>
<td style="text-align: left;">7.9 (2.3-22.9)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aug</td>
<td style="text-align: left;">1.1 (0.3-3.1)</td>
<td style="text-align: left;">1.4 (0.4-4)</td>
<td style="text-align: left;">1.4 (0.4-4)</td>
<td style="text-align: left;">2.7 (0.8-7.9)</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>individual_dailysal_count_df_plot <span class="ot">&lt;-</span> combined_salmon_count</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>individual_dailysal_count_df_plot<span class="sc">$</span>avg <span class="ot">&lt;-</span> individual_dailysal_count_df_plot<span class="sc">$</span>median</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>individual_dailysal_count_df_plot<span class="sc">$</span>ci_min <span class="ot">&lt;-</span> individual_dailysal_count_df_plot<span class="sc">$</span>ci_lower</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>individual_dailysal_count_df_plot<span class="sc">$</span>ci_max <span class="ot">&lt;-</span> individual_dailysal_count_df_plot<span class="sc">$</span>ci_upper</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>individual_dailysal_count_df_plot<span class="sc">$</span>Month <span class="ot">&lt;-</span> <span class="fu">factor</span>(individual_dailysal_count_df_plot<span class="sc">$</span>Month, <span class="at">levels =</span>  <span class="fu">c</span>(<span class="st">'Dec'</span>,<span class="st">'Jan'</span>, <span class="st">'Feb'</span>, <span class="st">'Mar'</span>, <span class="st">'Apr'</span>, <span class="st">'May'</span>,<span class="st">'Jun'</span>, <span class="st">'Jul'</span>, <span class="st">'Aug'</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'December'</span>,<span class="st">'January'</span>, <span class="st">'February'</span>, <span class="st">'March'</span>, <span class="st">'April'</span>, <span class="st">'May'</span>,<span class="st">'June'</span>, <span class="st">'July'</span>, <span class="st">'August'</span>))</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(individual_dailysal_count_df_plot, <span class="at">file=</span><span class="st">"code outputs/daily_count_consumed.csv"</span>)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>individual_dailysal_count_df_plot, <span class="fu">aes</span>(<span class="at">x=</span>Month, <span class="at">y=</span>avg, <span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max, <span class="at">group =</span> demo, <span class="at">fill =</span> demo))<span class="sc">+</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> demo)) <span class="sc">+</span> </span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">colour =</span> demo)) <span class="sc">+</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_min, <span class="at">ymax =</span> ci_max, <span class="at">color =</span> demo), <span class="at">alpha=</span><span class="fl">0.1</span>, </span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype=</span><span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>)  <span class="sc">+</span> </span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Month'</span>) <span class="sc">+</span> </span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Daily Age-0 Chinook Consumed per individual SSL'</span>)</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSL_consumption_11_20_24_files/figure-html/plot%20of%20daily%20biomass%20consumed%20by%20demographic%20group-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
